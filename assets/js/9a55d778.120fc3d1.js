"use strict";(self.webpackChunkredback_documentation=self.webpackChunkredback_documentation||[]).push([[189],{2192:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"cybersecurity/research/nagios/Redback_nagios_setup_guide","title":"Redback_nagios_setup_guide","description":"Last updated by \'22/09/2024\'","source":"@site/docs/cybersecurity/research/nagios/Redback_nagios_setup_guide.md","sourceDirName":"cybersecurity/research/nagios","slug":"/cybersecurity/research/nagios/Redback_nagios_setup_guide","permalink":"/redback-documentation/docs/cybersecurity/research/nagios/Redback_nagios_setup_guide","draft":false,"unlisted":false,"editUrl":"https://github.com/Redback-Operations/redback-documentation/blob/main/docs/cybersecurity/research/nagios/Redback_nagios_setup_guide.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Nagios-Report","permalink":"/redback-documentation/docs/cybersecurity/research/nagios/Nagios-Report"},"next":{"title":"virtual-private-cloud","permalink":"/redback-documentation/docs/cybersecurity/research/virtual-private-cloud"}}');var i=s(74848),r=s(28453);const t={sidebar_position:3},l="Redback Nagios Setup Guide",o={},c=[{value:"Running as Root",id:"running-as-root",level:2},{value:"Ubuntu:",id:"ubuntu",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Ubuntu 20.04:",id:"ubuntu-2004",level:3},{value:"Downloading the Source",id:"downloading-the-source",level:2},{value:"Compile",id:"compile",level:2},{value:"Create User and Group",id:"create-user-and-group",level:2},{value:"Install Binaries",id:"install-binaries",level:2},{value:"Install Service/Daemon",id:"install-servicedaemon",level:2},{value:"Install Command Mode",id:"install-command-mode",level:2},{value:"Install Configuration Files",id:"install-configuration-files",level:2},{value:"Install Apache Config Files",id:"install-apache-config-files",level:2},{value:"Configure Firewall",id:"configure-firewall",level:2},{value:"Create <code>nagiosadmin</code> User Account",id:"create-nagiosadmin-user-account",level:2},{value:"Start Apache Web Server",id:"start-apache-web-server",level:2},{value:"Start Nagios Service/Daemon",id:"start-nagios-servicedaemon",level:2},{value:"Test Nagios",id:"test-nagios",level:2},{value:"Installing Nagios Plugins",id:"installing-nagios-plugins",level:2},{value:"Prerequisites",id:"prerequisites-1",level:3},{value:"Downloading the Source",id:"downloading-the-source-1",level:3},{value:"Compile and Install",id:"compile-and-install",level:3},{value:"Test Plugins",id:"test-plugins",level:2},{value:"Service/Daemon Commands",id:"servicedaemon-commands",level:2},{value:"Ubuntu:",id:"ubuntu-1",level:3},{value:"Network Configuration for Nagios and IoT Devices",id:"network-configuration-for-nagios-and-iot-devices",level:2}];function d(e){const n={admonition:"admonition",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Last updated by:"})," yuhanhb, ",(0,i.jsx)(n.strong,{children:"Last updated on:"})," '22/09/2024'"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Last updated by:"})," yuhanhb, ",(0,i.jsx)(n.strong,{children:"Last updated on:"})," '22/09/2024'"]}),"\n",(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"redback-nagios-setup-guide",children:"Redback Nagios Setup Guide"})}),"\n",(0,i.jsx)(n.admonition,{type:"important",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Yuhan Bulathsinhalage"}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Date:"})," 21/09/2024"]})}),"\n",(0,i.jsx)(n.h1,{id:"redback-server---ubuntu-20046-lts-focal-fossa",children:"Redback server - Ubuntu 20.04.6 LTS (Focal Fossa)"}),"\n",(0,i.jsx)(n.h2,{id:"running-as-root",children:"Running as Root"}),"\n",(0,i.jsx)(n.p,{children:"All steps require running as root. To become root, simply run:"}),"\n",(0,i.jsx)(n.h3,{id:"ubuntu",children:"Ubuntu:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo -i\n"})}),"\n",(0,i.jsx)(n.p,{children:"All commands from this point onwards will be as root."}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsx)(n.h3,{id:"ubuntu-2004",children:"Ubuntu 20.04:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"apt-get update\r\napt-get install -y autoconf gcc libc6 make wget unzip apache2 apache2-utils php libgd-dev\r\napt-get install openssl libssl-dev\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"downloading-the-source",children:"Downloading the Source"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd /tmp\r\nwget -O nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.14.tar.gz\r\ntar xzf nagioscore.tar.gz\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"compile",children:"Compile"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd /tmp/nagioscore-nagios-4.4.14/\r\n./configure --with-httpd-conf=/etc/apache2/sites-enabled\r\nmake all\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"create-user-and-group",children:"Create User and Group"}),"\n",(0,i.jsxs)(n.p,{children:["This creates the ",(0,i.jsx)(n.code,{children:"nagios"})," user and group. The ",(0,i.jsx)(n.code,{children:"www-data"})," user is also added to the ",(0,i.jsx)(n.code,{children:"nagios"})," group."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"make install-groups-users\r\nusermod -a -G nagios www-data\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"install-binaries",children:"Install Binaries"}),"\n",(0,i.jsx)(n.p,{children:"This step installs the binary files, CGIs, and HTML files."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"make install\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"install-servicedaemon",children:"Install Service/Daemon"}),"\n",(0,i.jsx)(n.p,{children:"This installs the service/daemon files and configures them to start on boot."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"make install-daemoninit\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"install-command-mode",children:"Install Command Mode"}),"\n",(0,i.jsx)(n.p,{children:"This installs and configures the external command file."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"make install-commandmode\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"install-configuration-files",children:"Install Configuration Files"}),"\n",(0,i.jsxs)(n.p,{children:["This installs the ",(0,i.jsx)(n.em,{children:"SAMPLE"})," configuration files, required to start Nagios."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"make install-config\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"install-apache-config-files",children:"Install Apache Config Files"}),"\n",(0,i.jsx)(n.p,{children:"This installs the Apache web server configuration files and configures the Apache settings."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"make install-webconf\r\na2enmod rewrite\r\na2enmod cgi\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"configure-firewall",children:"Configure Firewall"}),"\n",(0,i.jsx)(n.p,{children:"Allow port 80 inbound traffic on the local firewall for Nagios Core web interface access."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"iptables -I INPUT -p tcp --destination-port 80 -j ACCEPT\r\napt-get install -y iptables-persistent\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Answer ",(0,i.jsx)(n.code,{children:"yes"})," to saving existing rules."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"create-nagiosadmin-user-account",children:["Create ",(0,i.jsx)(n.code,{children:"nagiosadmin"})," User Account"]}),"\n",(0,i.jsxs)(n.p,{children:["You'll need to create an Apache user account to log into Nagios. The following command will create a user account called ",(0,i.jsx)(n.code,{children:"nagiosadmin"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin\n"})}),"\n",(0,i.jsxs)(n.p,{children:["When adding additional users, remove ",(0,i.jsx)(n.code,{children:"-c"})," from the command to avoid replacing the existing ",(0,i.jsx)(n.code,{children:"nagiosadmin"})," user."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"start-apache-web-server",children:"Start Apache Web Server"}),"\n",(0,i.jsx)(n.p,{children:"Restart the Apache server after making the changes."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"systemctl restart apache2.service\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"start-nagios-servicedaemon",children:"Start Nagios Service/Daemon"}),"\n",(0,i.jsx)(n.p,{children:"Start the Nagios service."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"systemctl start nagios.service\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"test-nagios",children:"Test Nagios"}),"\n",(0,i.jsx)(n.p,{children:"Nagios is now running. To confirm, log into the Nagios Web Interface by pointing your browser to the IP address or FQDN of your Nagios Core server:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"http://10.25.5.143/nagios\r\nhttp://core-013.domain.local/nagios\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"nagiosadmin"})," as the username and the password (password = 123) you provided earlier."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"installing-nagios-plugins",children:"Installing Nagios Plugins"}),"\n",(0,i.jsx)(n.p,{children:"Nagios Core needs plugins to operate properly. Follow these steps to install Nagios Plugins."}),"\n",(0,i.jsx)(n.h3,{id:"prerequisites-1",children:"Prerequisites"}),"\n",(0,i.jsx)(n.p,{children:"Install the required packages:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"apt-get install -y autoconf gcc libc6 libmcrypt-dev make libssl-dev wget bc gawk dc build-essential snmp libnet-snmp-perl gettext\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"downloading-the-source-1",children:"Downloading the Source"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd /tmp\r\nwget --no-check-certificate -O nagios-plugins.tar.gz https://github.com/nagios-plugins/nagios-plugins/archive/release-2.4.6.tar.gz\r\ntar zxf nagios-plugins.tar.gz\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"compile-and-install",children:"Compile and Install"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd /tmp/nagios-plugins-release-2.4.6/\r\n./tools/setup\r\n./configure\r\nmake\r\nmake install\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"test-plugins",children:"Test Plugins"}),"\n",(0,i.jsx)(n.p,{children:"Point your browser to the Nagios Core server:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"http://10.25.5.143/nagios\r\nhttp://core-013.domain.local/nagios\n"})}),"\n",(0,i.jsx)(n.p,{children:'Go to a host or service object and "Re-schedule the next check" under the Commands menu. The previous error should now disappear and the correct output will appear.'}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"servicedaemon-commands",children:"Service/Daemon Commands"}),"\n",(0,i.jsx)(n.h3,{id:"ubuntu-1",children:"Ubuntu:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"systemctl start nagios.service\r\nsystemctl stop nagios.service\r\nsystemctl restart nagios.service\r\nsystemctl status nagios.service\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"network-configuration-for-nagios-and-iot-devices",children:"Network Configuration for Nagios and IoT Devices"}),"\n",(0,i.jsx)(n.p,{children:"Place the Nagios server and IoT devices on the same network to enable seamless communication. Ensure that the network supports the MQTT protocol for data exchange between the IoT devices and Nagios."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Port configuration for Nagios",src:s(71081).A+"",width:"936",height:"432"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Figure 1: Port configuration for Nagios"})}),"\n",(0,i.jsx)(n.p,{children:"Since there is another service running on port 80, change that to port 443 in order to run Nagios and create another Apache instance to access Nagios."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Apache 2 setup",src:s(30642).A+"",width:"625",height:"474"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Figure 2: Apache 2 setup"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},30642:(e,n,s)=>{s.d(n,{A:()=>a});const a=s.p+"assets/images/apache2-e230cfc2f18d460c47c1683e985e38f3.png"},71081:(e,n,s)=>{s.d(n,{A:()=>a});const a=s.p+"assets/images/port-0f95f12e2159e358aa193a40ab384892.png"},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var a=s(96540);const i={},r=a.createContext(i);function t(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);