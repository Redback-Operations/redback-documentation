"use strict";(self.webpackChunkredback_documentation=self.webpackChunkredback_documentation||[]).push([[6406],{49303:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"project-3/SafeCodeGuide","title":"Safe Code Guide","description":"Guide to secure code development for in-house pull request reviews.","source":"@site/docs/project-3/SafeCodeGuide.mdx","sourceDirName":"project-3","slug":"/project-3/SafeCodeGuide","permalink":"/redback-documentation/docs/project-3/SafeCodeGuide","draft":false,"unlisted":false,"editUrl":"https://github.com/Redback-Operations/redback-documentation/blob/main/docs/project-3/SafeCodeGuide.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"sidebar_label":"Safe Code Guide","title":"Safe Code Guide","description":"Guide to secure code development for in-house pull request reviews."},"sidebar":"tutorialSidebar","previous":{"title":"integration-of-data","permalink":"/redback-documentation/docs/project-3/integration-of-data"},"next":{"title":"Project 4","permalink":"/redback-documentation/docs/category/project-4"}}');var i=s(74848),r=s(28453);const o={sidebar_position:4,sidebar_label:"Safe Code Guide",title:"Safe Code Guide",description:"Guide to secure code development for in-house pull request reviews."},a=void 0,l={},d=[{value:"BRIEF OVERVIEW",id:"brief-overview",level:2},{value:"1. BROKEN ACCESS CONTROL",id:"1-broken-access-control",level:2},{value:"<strong><em>Gist</em></strong>",id:"gist",level:3},{value:"<strong><em>Look Out For</em></strong>",id:"look-out-for",level:3},{value:"<strong><em>Example</em></strong>",id:"example",level:3},{value:"2. CRYPTOGRAPHIC FAILURES",id:"2-cryptographic-failures",level:2},{value:"<strong><em>Gist</em></strong>",id:"gist-1",level:3},{value:"<strong><em>Look Out For</em></strong>",id:"look-out-for-1",level:3},{value:"<strong><em>Example</em></strong>",id:"example-1",level:3},{value:"3. INJECTION",id:"3-injection",level:2},{value:"<strong><em>Gist</em></strong>",id:"gist-2",level:3},{value:"<strong><em>Look Out For</em></strong>",id:"look-out-for-2",level:3},{value:"<strong><em>Example</em></strong>",id:"example-2",level:3},{value:"4. INSECURE DESIGN",id:"4-insecure-design",level:2},{value:"<strong><em>Gist</em></strong>",id:"gist-3",level:3},{value:"<strong><em>Look Out For</em></strong>",id:"look-out-for-3",level:3},{value:"<strong><em>Example</em></strong>",id:"example-3",level:3},{value:"5. SECURITY MISCONFIGURATION",id:"5-security-misconfiguration",level:2},{value:"<strong><em>Gist</em></strong>",id:"gist-4",level:3},{value:"<strong><em>Look Out For</em></strong>",id:"look-out-for-4",level:3},{value:"<strong><em>Example</em></strong>",id:"example-4",level:3},{value:"6. VULNERABLE AND OUTDATED COMPONENTS",id:"6-vulnerable-and-outdated-components",level:2},{value:"<strong><em>Gist</em></strong>",id:"gist-5",level:3},{value:"<strong><em>Look Out For</em></strong>",id:"look-out-for-5",level:3},{value:"<strong><em>Example</em></strong>",id:"example-5",level:3},{value:"7. IDENTIFICATION AND AUTHENTICATION FAILURES",id:"7-identification-and-authentication-failures",level:2},{value:"<strong><em>Gist</em></strong>",id:"gist-6",level:3},{value:"<strong><em>Look Out For</em></strong>",id:"look-out-for-6",level:3},{value:"<strong><em>Example</em></strong>",id:"example-6",level:3},{value:"8. SOFTWARE AND DATA INTEGRITY FAILURES",id:"8-software-and-data-integrity-failures",level:2},{value:"<strong><em>Gist</em></strong>",id:"gist-7",level:3},{value:"<strong><em>Look Out For</em></strong>",id:"look-out-for-7",level:3},{value:"<strong><em>Example</em></strong>",id:"example-7",level:3},{value:"9. SECURITY LOGGING AND MONITORING FAILURES",id:"9-security-logging-and-monitoring-failures",level:2},{value:"<strong><em>Gist</em></strong>",id:"gist-8",level:3},{value:"<strong><em>Look Out For</em></strong>",id:"look-out-for-8",level:3},{value:"<strong><em>Example</em></strong>",id:"example-8",level:3},{value:"10. SERVER-SIDE REQUEST FORGERY (SSRF)",id:"10-server-side-request-forgery-ssrf",level:2},{value:"<strong><em>Gist</em></strong>",id:"gist-9",level:3},{value:"<strong><em>Look Out For</em></strong>",id:"look-out-for-9",level:3},{value:"<strong><em>Example</em></strong>",id:"example-9",level:3}];function c(e){const n={a:"a",em:"em",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)("div",{style:{width:"100%"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{width:"20%",textAlign:"center"},children:"Version"}),(0,i.jsx)("th",{style:{width:"20%",textAlign:"center"},children:"Modified By"}),(0,i.jsx)("th",{style:{width:"20%",textAlign:"center"},children:"Approver"}),(0,i.jsx)("th",{style:{width:"20%",textAlign:"center"},children:"Date"}),(0,i.jsx)("th",{style:{width:"20%",textAlign:"center"},children:"Changes made"})]})}),(0,i.jsx)("tbody",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{textAlign:"center"},children:"V1.0"}),(0,i.jsx)("td",{style:{textAlign:"center"},children:"Codey Funston"}),(0,i.jsx)("td",{style:{textAlign:"center"},children:"Codey Funston"}),(0,i.jsx)("td",{style:{textAlign:"center"},children:"01/01/2025"}),(0,i.jsx)("td",{style:{textAlign:"center"},children:"Document Creation"})]})})]})}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}}),"\n",(0,i.jsx)(n.h2,{id:"brief-overview",children:"BRIEF OVERVIEW"}),"\n",(0,i.jsx)(n.p,{children:"This guide is based on the way that SecDevOps team members are advised to review pull requests from other projects. To reduce complexity for junior members and to ensure the most important security risks are looked out for, we check code against the OWASP top 10 web application critical security risks."}),"\n",(0,i.jsx)(n.p,{children:"OWASP stands for the Open Web Application Security Project. It is an open-source project that reaches out to key industry players every 4-5 years and collects data on the most critical cyber security issues pertaining to application development. Based on the data they compose the top 10 most important issues and release this is in their awareness document. The most recent one is OWASP Top 10:2021, with the next one coming soon around mid 2025."}),"\n",(0,i.jsx)(n.p,{children:"This source of security issues is well regarded in industry and is a perfect starting point for developers without much cyber security training. If you want to read more about it, the links below point to information from their website and good quality third parties."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["[OWASP Top Ten Overview](",(0,i.jsx)(n.a,{href:"https://owasp.org/www-project-to-",children:"https://owasp.org/www-project-to-"})]}),"\n",(0,i.jsxs)(n.li,{children:["[2021 Version \u2013 Extra Information](",(0,i.jsx)(n.a,{href:"https://owasp.org/-",children:"https://owasp.org/-"})]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.youtube.com/watch?v=hryt-rCLJUA&t=68s",children:"10 Minute Youtube Video \u2013 By Cyber Citadel"})}),"\n",(0,i.jsxs)(n.li,{children:["For those interested in LLM Security: ",(0,i.jsx)(n.a,{href:"https://www.youtube.com/watch?v=cYuesqIKf9A",children:"How the Top 10 Apply for LLM\u2019s - IBM"})]}),"\n",(0,i.jsxs)(n.li,{children:["For those who want to experiment with live examples of insecure web applications: ",(0,i.jsx)(n.a,{href:"https://github.com/lighthouse-labs/owasp-top-10-examples",children:"OWASP Top 10 Examples - GitHub"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"In this guide I will be going through key things to look out for and examples from past semester\u2019s pull requests in your project. Hopefully this will make it easier to understand and increase your ability to prevent un-safe code production from the start of the development life cycle."}),"\n",(0,i.jsx)(n.p,{children:"Note: A lot of the examples are like pseudo code and wouldn\u2019t be used as is, however, they are helpful for understanding the principle so that you can apply/avoid the preventative measure or risk respectively."}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}}),"\n",(0,i.jsx)(n.h2,{id:"1-broken-access-control",children:"1. BROKEN ACCESS CONTROL"}),"\n",(0,i.jsx)(n.h3,{id:"gist",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Gist"})})}),"\n",(0,i.jsxs)(n.p,{children:["Access to resources and functionality should be enforced based on who is accessing it. Everything should be denied by default with any access given with the least amount of privilege possible. This is referred to as ",(0,i.jsx)(n.em,{children:"whitelisting"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"look-out-for",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Look Out For"})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"API\u2019s having the same permissions for all methods. This isn\u2019t just important for \u201csetters\u201d like POST, but \u201cgetters\u201d like GET. For example, you may centre your concern around preventing any damage to data through malicious POST and DELETE operations. However, that is more of a concern for maintaining the state of a system, not protecting it from getting data stolen with a GET request."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Exposing sensitive data through complex manipulation in the back end. For example, as illustrated in the example, SQL queries could result columns being returned that hold sensitive information. In the case of your exercise data there may be location information. To prevent this there should be a good understanding of data fields and data manipulation effects."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Example"})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(21292).A+"",width:"3376",height:"1928"})}),"\n",(0,i.jsx)(n.p,{children:"This example is quite basic and clearly not safe by using the wildcard (*). However, it highlights the concept of a data query returning unwanted fields (latitude and longitude)."}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}}),"\n",(0,i.jsx)(n.h2,{id:"2-cryptographic-failures",children:"2. CRYPTOGRAPHIC FAILURES"}),"\n",(0,i.jsx)(n.h3,{id:"gist-1",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Gist"})})}),"\n",(0,i.jsx)(n.p,{children:"Are the correct protocols, tools, and standards being used to protect data at rest and in transit? If not, they should be updated to be as secure as \u201creasonably practicable\u201d (it is a balancing act as too much security can slow down software or add more complexity). For example, it would be unnecessary to use multi factor authentication for a login that is only used for marketing purposes since this would slow down the user for no extra gain."}),"\n",(0,i.jsx)(n.h3,{id:"look-out-for-1",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Look Out For"})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Try to use HTTPS over HTTP."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Encrypt sensitive data when moving it between stores."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Don\u2019t place sensitive data in the public facing GitHub repository."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Regularly check the encryption versions used if manually encrypting data on servers. Use the latest ones once they have been tested."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Store passwords as their hashes."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-1",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Example"})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(58967).A+"",width:"2952",height:"1448"})}),"\n",(0,i.jsx)(n.p,{children:"This is similar to a common issue that comes up in pull request reviews, where login credentials are hardcoded for request code. Similarly, even if the passwords are stored on a database on the server, no extra effort is required for attackers to work out passwords once stolen if they are plain text."}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}}),"\n",(0,i.jsx)(n.h2,{id:"3-injection",children:"3. INJECTION"}),"\n",(0,i.jsx)(n.h3,{id:"gist-2",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Gist"})})}),"\n",(0,i.jsx)(n.p,{children:"Input from the user should not be used directly without checks and changes if necessary. Even if the data is being stored or used somewhere that is not vital to the program, or consists of sensitive information, it can still be used maliciously with clever syntax tricks."}),"\n",(0,i.jsx)(n.h3,{id:"look-out-for-2",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Look Out For"})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Escape characters which have logical meaning in the language that is working with the data."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Something mentioned on the OWASP website which I think is pretty cool is preventing users from entering data structure names that cannot be escaped. One way to get around this with SQL tables is to name them differently to their front-end display. This is what I used in the example instead of a standard SQL injection with special characters."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Parameterize database queries."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-2",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Example"})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(96299).A+"",width:"2496",height:"1352"})}),"\n",(0,i.jsx)(n.p,{children:"Here the table name is \u201cobfuscated\u201d slightly by not using an obvious name like \u201cusers\u201d."}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}}),"\n",(0,i.jsx)(n.h2,{id:"4-insecure-design",children:"4. INSECURE DESIGN"}),"\n",(0,i.jsx)(n.h3,{id:"gist-3",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Gist"})})}),"\n",(0,i.jsx)(n.p,{children:"Insecure design's a funny one because it isn't a specific feature of a piece of software that you should avoid or implement to prevent security risks. Instead it is more about how to approach the development process to ensure that security flaws are not built in to your system. Essentially you should consider the security risks of each part of your design and included risk assessments as you go."}),"\n",(0,i.jsx)(n.h3,{id:"look-out-for-3",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Look Out For"})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Think about how an attacker might take advantage of a process, data storage, or core piece of logic."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:'Perform security checks regularly, trying to adhere to a secure DevOps practice, or "SecDevOps".'}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Use industry proven designs if possible, or seek advice from others with security experience when creating designs in-house."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"IMPORTANT: Don't leave security to last in the development process!"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-3",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Example"})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(72933).A+"",width:"3876",height:"2028"})}),"\n",(0,i.jsxs)(n.p,{children:["The example I have used here is from the project's web app code. This is definitely not poorly written or designed as the sign in function was not fully setup when I was writing this :) If this code was left as is it would be prone to a brute force attack. This is because there is no functionality to stop allowing the client to try their username and password combination after a certain amount of tries.\r\n\xad",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}})]}),"\n",(0,i.jsx)(n.h2,{id:"5-security-misconfiguration",children:"5. SECURITY MISCONFIGURATION"}),"\n",(0,i.jsx)(n.h3,{id:"gist-4",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Gist"})})}),"\n",(0,i.jsx)(n.p,{children:"The software and environment settings should be planned, documented, reviewed and kept consistent. Make sure you check any 3rd party tools for default settings which add security risks to your system."}),"\n",(0,i.jsx)(n.h3,{id:"look-out-for-4",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Look Out For"})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Use whitelist approach with permission configurations."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Keep configurations consistent across all environments and setups of the software."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Don't give global access to make configuration changes."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Consult other team members before making changes such as ports or user access."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Remove/change default credentials because these are very easy to find online with searches on forums."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-4",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Example"})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(51028).A+"",width:"3224",height:"1164"})}),"\n",(0,i.jsx)(n.p,{children:"In this example an API token is hardcoded into the code for the request. As mentioned\r\nabove this is a common issue in pull request reviews. To use use tokens in code without including them in plain text you can store them with 3rd party services like cloud token hosting, or you can save them as environment variables on the server running the code."}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}}),"\n",(0,i.jsx)(n.h2,{id:"6-vulnerable-and-outdated-components",children:"6. VULNERABLE AND OUTDATED COMPONENTS"}),"\n",(0,i.jsx)(n.h3,{id:"gist-5",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Gist"})})}),"\n",(0,i.jsx)(n.p,{children:"Modern software is made up of a large number of inter-reliant parts that include in-house and 3rd party developers. Updates and patching are not automatic and require up to date knowledge of changes."}),"\n",(0,i.jsx)(n.h3,{id:"look-out-for-5",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Look Out For"})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Document each component in the system as you build it to gain insight into dependency mappings."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Use automation tools to scan code repositories for outdated packages or ones with\r\nknown security risks."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"When adding dependencies make sure to subscribe to change alerts and newsletters."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Always perform testing when updating or patching, not just when changing code."})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-5",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Example"})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(78832).A+"",width:"2496",height:"1236"})}),"\n",(0,i.jsx)(n.p,{children:"To illustrate how important it is to track your dependencies is, this single line includes the JavaScript Keras package. Within that package, 18 other packages are included, and within them who knows how many. It is impossible nowadays to write code from scratch or with just the standard libraries, and it is also impossible to directly verify every dependency relation within imported packages. That is why it is important to ensure all other areas of the system are secure, and that you use tools that can perform deep dependency scanning for you."}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}}),"\n",(0,i.jsx)(n.h2,{id:"7-identification-and-authentication-failures",children:"7. IDENTIFICATION AND AUTHENTICATION FAILURES"}),"\n",(0,i.jsx)(n.h3,{id:"gist-6",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Gist"})})}),"\n",(0,i.jsx)(n.p,{children:"Similar to broken access control (3). Have strong user authentication features and layering to prevent single points of entry. Don't allow bot-like actions to be used to bypass authentication with randomly generated user identification."}),"\n",(0,i.jsx)(n.h3,{id:"look-out-for-6",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Look Out For"})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Set up multi-factor authentication when the resource or functionality being accessed has high value, data sensitivity, or power."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Do not ever store passwords in plain text. If they are stolen there is no more protection."})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Prevent brute force attacks by stopping too many repeated attempts at login."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Test user accounts for weak passwords that would be included in most dictionaries."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-6",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Example"})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(9561).A+"",width:"3608",height:"1644"})}),"\n",(0,i.jsx)(n.p,{children:"This is a sneaky method to prevent bad actors from accessing your system's resources. It works by baiting port sniffing with unused ports that have no services listening on them. As soon as someone sniffs one of the bait ports their IP is blocked entirely from every port."}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}}),"\n",(0,i.jsx)(n.h2,{id:"8-software-and-data-integrity-failures",children:"8. SOFTWARE AND DATA INTEGRITY FAILURES"}),"\n",(0,i.jsx)(n.h3,{id:"gist-7",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Gist"})})}),"\n",(0,i.jsx)(n.p,{children:"Assume the worst of other pieces of software and data. Whenever possible verify that software and external data is from who it says it is through signatures. Don't trust anything outside of your own artifacts."}),"\n",(0,i.jsx)(n.h3,{id:"look-out-for-7",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Look Out For"})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Check digital signatures."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Perform file hashes against trusted values to ensure file integrity."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Use industry trusted repositories."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-7",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Example"})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(86236).A+"",width:"3336",height:"1544"})}),"\n",(0,i.jsxs)(n.p,{children:["When downloading any file from an external source, after verifying its identify you should check the hash. This only has meaning when the file provider gives the hash. In the example the script prevents any execution when the files do not match by using 444 with ",(0,i.jsx)(n.em,{children:"chmod"})," to set it to read only for all users."]}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}}),"\n",(0,i.jsx)(n.h2,{id:"9-security-logging-and-monitoring-failures",children:"9. SECURITY LOGGING AND MONITORING FAILURES"}),"\n",(0,i.jsx)(n.h3,{id:"gist-8",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Gist"})})}),"\n",(0,i.jsx)(n.p,{children:"You can't do anything about a security issue if you don't know about it. Monitoring and proper logging is required to gain valuable insight into issues so that they can be resolved."}),"\n",(0,i.jsx)(n.h3,{id:"look-out-for-8",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Look Out For"})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Only log useful error information to people within the company. Providing too much information can aid bad actors."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"When setting up internal logging functions in code, give as much information as possible."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Monitor groups of events and try to collate information."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Send important logs off to remote data stores so that they cannot be deleted by bad actors."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-8",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Example"})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(72147).A+"",width:"3068",height:"1356"})}),"\n",(0,i.jsx)(n.p,{children:"In this example when the error thrown by the system is HIGH or above it may have to be kept for legal reasons such as sensitive user data leaks. It uses two sample functions. One to log to the usual place so that it is picked up by team members (the event itself should trigger monitoring), and the other to send it to a remote data store so that it can't be deleted by the bad actor that may have access to the server's file system."}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}}),"\n",(0,i.jsx)(n.h2,{id:"10-server-side-request-forgery-ssrf",children:"10. SERVER-SIDE REQUEST FORGERY (SSRF)"}),"\n",(0,i.jsx)(n.h3,{id:"gist-9",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Gist"})})}),"\n",(0,i.jsx)(n.p,{children:'The server\'s file system contains data that attackers could use for malicious purposes. "Internal" file requests on the server can be injected by attackers.'}),"\n",(0,i.jsx)(n.h3,{id:"look-out-for-9",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Look Out For"})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Don't allow HTTP redirects from user controls."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Like (3) make sure any user input is checked and goes through sanitation before use."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Change file permissions for sensitive data to only allow access to users other than the one running the program."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Use whitelisting for internal network traffic so that even if an attacker passes other security measures they can't bypass the firewall/access control list."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-9",children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Example"})})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(8292).A+"",width:"3568",height:"1256"})}),"\n",(0,i.jsx)(n.p,{children:"Here as soon as the server starts listening any outgoing HTTP request is denied."}),"\n",(0,i.jsx)("div",{style:{height:"4px",width:"100%",background:"#FFA500",margin:"20px 0"}})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8292:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/SSRF-eg-b7076e7c2dbf653a751cd48ba1f7cee4.png"},21292:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/broken-access-control-eg-90167bfbc5c9eedbef300dba5520a2e6.png"},58967:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/cryptographic-failures-eg-82e273d51ff18db70a348dffbc76462f.png"},9561:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/identification-and-authentication-failures-eg-2c9f8748faba192e0f51509083ed1bce.png"},96299:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/injection-eg-91da3e3c4d6254998bfbb2a15eeb5822.png"},72933:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/insecure-design-eg-c69cab8b4f067db2768faf7a46b277d0.png"},72147:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/security-logging-and-monitoring-failures-eg-6abaaa2ebd011fa6c72092098d45f49b.png"},51028:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/security-misconfiguration-eg-0717b80e80075c51744d6fccf960f8aa.png"},86236:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/software-and-data-integrity-failures-eg-f500d74fabf6929e79f7fb07c26357d8.png"},78832:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/vulnerable-and-outdated-components-eg-f2c66c2ab7e9f03bb9834c9a6a1fa154.png"},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var t=s(96540);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);