"use strict";(self.webpackChunkredback_documentation=self.webpackChunkredback_documentation||[]).push([[18],{39343:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"data-warehousing/Mosquitto/mosquitto_documentation","title":"mosquitto_documentation","description":"Last updated by \'09/05/2025\'","source":"@site/docs/data-warehousing/Mosquitto/mosquitto_documentation.md","sourceDirName":"data-warehousing/Mosquitto","slug":"/data-warehousing/Mosquitto/mosquitto_documentation","permalink":"/redback-documentation/docs/data-warehousing/Mosquitto/mosquitto_documentation","draft":false,"unlisted":false,"editUrl":"https://github.com/Redback-Operations/redback-documentation/blob/main/docs/data-warehousing/Mosquitto/mosquitto_documentation.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"Mosquitto MQTT Broker"},"sidebar":"tutorialSidebar","previous":{"title":"Mosquitto","permalink":"/redback-documentation/docs/category/mosquitto"},"next":{"title":"Restic","permalink":"/redback-documentation/docs/category/restic"}}');var i=s(74848),r=s(28453);const o={sidebar_position:2,sidebar_label:"Mosquitto MQTT Broker"},d="Mosquitto MQTT Broker",l={},c=[{value:"Overview",id:"overview",level:2},{value:"System Details",id:"system-details",level:2},{value:"Installation Summary",id:"installation-summary",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Primary Config File",id:"primary-config-file",level:3},{value:"Key Parameters",id:"key-parameters",level:3},{value:"Logs &amp; Monitoring",id:"logs--monitoring",level:2},{value:"View Log Output",id:"view-log-output",level:3},{value:"Common Log Entries",id:"common-log-entries",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"File &amp; Directory Summary",id:"file--directory-summary",level:2}];function a(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Last updated by:"})," RichardWhellum, ",(0,i.jsx)(t.strong,{children:"Last updated on:"})," '09/05/2025'"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Last updated by:"})," RichardWhellum, ",(0,i.jsx)(t.strong,{children:"Last updated on:"})," '09/05/2025'"]}),"\n",(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"mosquitto-mqtt-broker",children:"Mosquitto MQTT Broker"})}),"\n",(0,i.jsx)(t.admonition,{type:"info",children:(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Document Creation:"})," 6 May, 2025. ",(0,i.jsx)(t.strong,{children:"Last Edited:"})," 6 May, 2025. ",(0,i.jsx)(t.strong,{children:"Authors:"})," Richard Whellum.\r\n",(0,i.jsx)("br",{})," ",(0,i.jsx)(t.strong,{children:"Document Code:"})," DOC1. ",(0,i.jsx)(t.strong,{children:"Effective Date:"})," 6 May, 2025. ",(0,i.jsx)(t.strong,{children:"Expiry Date:"})," 6 May, 2026."]})}),"\n",(0,i.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(t.p,{children:["This document outlines the configuration, usage, and operational practices for the ",(0,i.jsx)(t.strong,{children:"Mosquitto MQTT Broker"})," deployed on the ",(0,i.jsx)(t.strong,{children:"Data Warehouse Ubuntu VM"})," (",(0,i.jsx)(t.code,{children:"10.137.0.149"}),")."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Eclipse Mosquitto"})," is a lightweight, open-source MQTT (Message Queuing Telemetry Transport) broker optimised for minimal network usage and ideal for IoT or lightweight messaging systems. It supports MQTT versions 3.1, 3.1.1, and 5.0."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"system-details",children:"System Details"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Setting"}),(0,i.jsx)(t.th,{children:"Value"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Host OS"})}),(0,i.jsx)(t.td,{children:"Ubuntu"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Broker IP"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"10.137.0.149"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Port"})}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"1883"})," (unencrypted, default)"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Persistence"})}),(0,i.jsx)(t.td,{children:"Enabled"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Logging"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"/var/log/mosquitto/mosquitto.log"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Anonymous Access"})}),(0,i.jsx)(t.td,{children:"Enabled (no restrictions configured)"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"TLS/Authentication"})}),(0,i.jsx)(t.td,{children:"Not configured"})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"installation-summary",children:"Installation Summary"}),"\n",(0,i.jsx)(t.p,{children:"To install and enable the Mosquitto broker and client tools:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"sudo apt update\r\nsudo apt install -y mosquitto mosquitto-clients\r\nsudo systemctl enable mosquitto\r\nsudo systemctl start mosquitto\n"})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(t.h3,{id:"primary-config-file",children:"Primary Config File"}),"\n",(0,i.jsxs)(t.p,{children:["Path: ",(0,i.jsx)(t.code,{children:"/etc/mosquitto/mosquitto.conf"})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-conf",children:"pid_file /var/run/mosquitto.pid\r\n\r\n# Persistence\r\npersistence true\r\npersistence_location /var/lib/mosquitto/\r\n\r\n# Logging\r\nlog_dest file /var/log/mosquitto/mosquitto.log\r\nlog_type all\r\n\r\n# Include additional configs\r\ninclude_dir /etc/mosquitto/conf.d\n"})}),"\n",(0,i.jsx)(t.p,{children:"Common options:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Option"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"listener <port>"})}),(0,i.jsx)(t.td,{children:"Set the port the broker listens on"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"allow_anonymous"})}),(0,i.jsx)(t.td,{children:"Allow connections without username/password"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"persistence true"})}),(0,i.jsx)(t.td,{children:"Enable message persistence"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"log_dest stdout"})}),(0,i.jsx)(t.td,{children:"Log output to stdout (useful for Docker)"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"password_file"})}),(0,i.jsx)(t.td,{children:"File containing valid user credentials"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"key-parameters",children:"Key Parameters"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Persistence"})," ensures messages and subscriptions survive broker restarts."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Logging"})," is set to capture all message and connection-related activity."]}),"\n",(0,i.jsx)(t.li,{children:"`` allows modular configuration files (e.g., future access control or TLS settings)."}),"\n"]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"logs--monitoring",children:"Logs & Monitoring"}),"\n",(0,i.jsx)(t.h3,{id:"view-log-output",children:"View Log Output"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"sudo tail -f /var/log/mosquitto/mosquitto.log\n"})}),"\n",(0,i.jsx)(t.h3,{id:"common-log-entries",children:"Common Log Entries"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Connection status"}),"\n",(0,i.jsx)(t.li,{children:"Topic subscriptions"}),"\n",(0,i.jsx)(t.li,{children:"Message publishing"}),"\n",(0,i.jsx)(t.li,{children:"Errors or config issues"}),"\n"]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Problem"}),(0,i.jsx)(t.th,{children:"Suggested Fix"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Port 1883 not open or refused"}),(0,i.jsxs)(t.td,{children:["Confirm the service is active: ",(0,i.jsx)(t.code,{children:"sudo systemctl status mosquitto"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Messages not received"}),(0,i.jsx)(t.td,{children:"Verify topic names and client connectivity"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Broker fails to start"}),(0,i.jsxs)(t.td,{children:["Check config file syntax and permissions in ",(0,i.jsx)(t.code,{children:"conf.d/"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Log file not updating"}),(0,i.jsxs)(t.td,{children:["Ensure write permissions for ",(0,i.jsx)(t.code,{children:"/var/log/mosquitto/"})]})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"file--directory-summary",children:"File & Directory Summary"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Path"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"/etc/mosquitto/mosquitto.conf"})}),(0,i.jsx)(t.td,{children:"Main broker configuration"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"/etc/mosquitto/conf.d/"})}),(0,i.jsx)(t.td,{children:"Directory for additional configs"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"/var/log/mosquitto/mosquitto.log"})}),(0,i.jsx)(t.td,{children:"Primary log file"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"/var/lib/mosquitto/"})}),(0,i.jsx)(t.td,{children:"Persistence data location"})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>d});var n=s(96540);const i={},r=n.createContext(i);function o(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);