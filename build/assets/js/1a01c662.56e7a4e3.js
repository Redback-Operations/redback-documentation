"use strict";(self.webpackChunkredback_documentation=self.webpackChunkredback_documentation||[]).push([[5823],{30609:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"cybersecurity/Blue Team/ids-and-wazuh/Wazuh Login Troubleshooting Report","title":"Wazuh Login Troubleshooting Report","description":"Last updated by \'16/05/2025\'","source":"@site/docs/cybersecurity/Blue Team/ids-and-wazuh/Wazuh Login Troubleshooting Report.md","sourceDirName":"cybersecurity/Blue Team/ids-and-wazuh","slug":"/cybersecurity/Blue Team/ids-and-wazuh/Wazuh Login Troubleshooting Report","permalink":"/redback-documentation/docs/cybersecurity/Blue Team/ids-and-wazuh/Wazuh Login Troubleshooting Report","draft":false,"unlisted":false,"editUrl":"https://github.com/Redback-Operations/redback-documentation/blob/main/docs/cybersecurity/Blue Team/ids-and-wazuh/Wazuh Login Troubleshooting Report.md","tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"sidebar_position":13},"sidebar":"tutorialSidebar","previous":{"title":"wazuh-backup-redeploy","permalink":"/redback-documentation/docs/cybersecurity/Blue Team/ids-and-wazuh/wazuh-backup-redeploy"},"next":{"title":"Virus_Total","permalink":"/redback-documentation/docs/cybersecurity/Blue Team/ids-and-wazuh/Virus_Total"}}');var a=r(74848),t=r(28453);const i={sidebar_position:13},d="Wazuh Login Troubleshooting Report",o={},c=[{value:"Summary",id:"summary",level:2},{value:"Issue Summary",id:"issue-summary",level:2},{value:"Root Cause Analysis",id:"root-cause-analysis",level:2},{value:"1. <strong>Credential Errors</strong>",id:"1-credential-errors",level:3},{value:"2. <strong>Keystore Permission Denied</strong>",id:"2-keystore-permission-denied",level:3},{value:"3. <strong>Missing SSL Certificate</strong>",id:"3-missing-ssl-certificate",level:3},{value:"Troubleshooting Steps",id:"troubleshooting-steps",level:2},{value:"Step 1: Verified Service Status",id:"step-1-verified-service-status",level:3},{value:"Step 2: Reset Credentials",id:"step-2-reset-credentials",level:3},{value:"Step 3: Updated Keystore",id:"step-3-updated-keystore",level:3},{value:"Step 4: Regenerated Missing SSL Files",id:"step-4-regenerated-missing-ssl-files",level:3},{value:"Step 5: Adjusted Permissions",id:"step-5-adjusted-permissions",level:3},{value:"Step 6: Restarted Services",id:"step-6-restarted-services",level:3},{value:"Outcome",id:"outcome",level:4},{value:"Appendix",id:"appendix",level:4}];function l(e){const s={admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Last updated by:"})," bg-11, ",(0,a.jsx)(s.strong,{children:"Last updated on:"})," '16/05/2025'"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Last updated by:"})," bg-11, ",(0,a.jsx)(s.strong,{children:"Last updated on:"})," '16/05/2025'"]}),"\n",(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"wazuh-login-troubleshooting-report",children:"Wazuh Login Troubleshooting Report"})}),"\n",(0,a.jsxs)(s.admonition,{type:"info",children:[(0,a.jsx)(s.p,{children:"Document Creation: 2025-04-9. Last Edited: 2025-04-26. Authors: Elvis Ifeanyi Nwosu"}),(0,a.jsx)(s.p,{children:"Document Code: Wazuh_Login_Troubleshooting_V1. Effective Date: 2025-04-26. Expiry Date: 2026-04-26"})]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"System:"})," Wazuhs Full Stack Deployment (Manager, Indexer, Dashboard) on Local VM"]}),"\n",(0,a.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,a.jsx)(s.p,{children:"This report documents the troubleshooting process undertaken to resolve login issues encountered while accessing the Wazuh Dashboard after full stack deployment. The process involved validating service statuses, resetting credentials, fixing permission issues, and regenerating SSL certificates."}),"\n",(0,a.jsx)(s.h2,{id:"issue-summary",children:"Issue Summary"}),"\n",(0,a.jsx)(s.p,{children:"Following deployment of the Wazuh manager, indexer, and dashboard, login attempts to the Wazuh web interface failed. The failure was accompanied by:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Credential mismatch errors."}),"\n",(0,a.jsx)(s.li,{children:"Permission-denied issues when updating the keystore."}),"\n",(0,a.jsxs)(s.li,{children:["SSL file not found (",(0,a.jsx)(s.code,{children:"dashboard-key.pem"}),") error."]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"root-cause-analysis",children:"Root Cause Analysis"}),"\n",(0,a.jsxs)(s.h3,{id:"1-credential-errors",children:["1. ",(0,a.jsx)(s.strong,{children:"Credential Errors"})]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Default login credentials (",(0,a.jsx)(s.code,{children:"admin/admin"}),") were not accepted."]}),"\n",(0,a.jsx)(s.li,{children:"Manual user creation and password reset did not resolve the issue immediately."}),"\n"]}),"\n",(0,a.jsxs)(s.h3,{id:"2-keystore-permission-denied",children:["2. ",(0,a.jsx)(s.strong,{children:"Keystore Permission Denied"})]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Attempt to update the ",(0,a.jsx)(s.code,{children:"opensearch-dashboards-keystore"})," failed due to lack of root privileges."]}),"\n"]}),"\n",(0,a.jsxs)(s.h3,{id:"3-missing-ssl-certificate",children:["3. ",(0,a.jsx)(s.strong,{children:"Missing SSL Certificate"})]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Wazuh dashboard failed to start due to missing ",(0,a.jsx)(s.code,{children:"/etc/wazuh-dashboard/certs/dashboard-key.pem"}),"."]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"troubleshooting-steps",children:"Troubleshooting Steps"}),"\n",(0,a.jsx)(s.h3,{id:"step-1-verified-service-status",children:"Step 1: Verified Service Status"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"sudo systemctl status wazuh-manager\r\nsudo systemctl status wazuh-dashboard\r\nsudo systemctl status wazuh-indexer\n"})}),"\n",(0,a.jsx)(s.p,{children:"Confirmed manager was active but Dashboard and indexer failed."}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Screenshot of Service Status wazuh-dashboard:"}),(0,a.jsx)(s.br,{}),"\n",(0,a.jsx)(s.img,{alt:"Service Status wazuh-dashboard",src:r(68504).A+"",width:"1355",height:"432"})]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Screenshot of Service Status wazuh-indexer:"}),"\r\n",(0,a.jsx)(s.img,{alt:"Service Status wazuh-indexer",src:r(91150).A+"",width:"1614",height:"355"})]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Screenshot of Service Status wazuh-manager:"}),"\r\n",(0,a.jsx)(s.img,{alt:"Service Status wazuh-manager",src:r(90647).A+"",width:"1121",height:"268"})]}),"\n",(0,a.jsx)(s.h3,{id:"step-2-reset-credentials",children:"Step 2: Reset Credentials"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"sudo /usr/share/wazuh-indexer/plugins/opensearch-security/tools/wazuh-passwords-tool.sh --change-all\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Successfully reset passwords for users including ",(0,a.jsx)(s.code,{children:"kibanaserver"}),"."]}),"\n",(0,a.jsx)(s.h3,{id:"step-3-updated-keystore",children:"Step 3: Updated Keystore"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"echo '<new-password>' | /usr/share/wazuh-dashboard/bin/opensearch-dashboards-keystore --allow-root add -f --stdin opensearch.password\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Note: Initial attempts failed due to insufficient permissions. Switching to root user (",(0,a.jsx)(s.code,{children:"sudo -i"}),") resolved the issue."]}),"\n",(0,a.jsx)(s.h3,{id:"step-4-regenerated-missing-ssl-files",children:"Step 4: Regenerated Missing SSL Files"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"sudo mkdir -p /etc/wazuh-dashboard/certs\r\nsudo openssl genrsa -out /etc/wazuh-dashboard/certs/dashboard-key.pem 2048\r\nsudo openssl req -new -key /etc/wazuh-dashboard/certs/dashboard-key.pem -out /etc/wazuh-dashboard/certs/dashboard.csr\r\nsudo openssl x509 -req -in /etc/wazuh-dashboard/certs/dashboard.csr -signkey /etc/wazuh-dashboard/certs/dashboard-key.pem -out /etc/wazuh-dashboard/certs/dashboard-cert.pem -days 365\n"})}),"\n",(0,a.jsx)(s.p,{children:"Successfully created private key and certificate."}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Screenshot of regenerated dashboard certs:"}),(0,a.jsx)(s.br,{}),"\n",(0,a.jsx)(s.img,{alt:"regenerated dashboard certificates",src:r(89633).A+"",width:"762",height:"38"})]}),"\n",(0,a.jsx)(s.h3,{id:"step-5-adjusted-permissions",children:"Step 5: Adjusted Permissions"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"sudo chown -R wazuh:wazuh /etc/wazuh-dashboard/certs\r\nsudo chmod 600 /etc/wazuh-dashboard/certs/dashboard-key.pem\n"})}),"\n",(0,a.jsx)(s.p,{children:"Ensured proper access rights for dashboard service."}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Screenshots of access permisssions"}),"\r\n",(0,a.jsx)(s.img,{alt:"Access rights permissions",src:r(32202).A+"",width:"709",height:"129"})]}),"\n",(0,a.jsx)(s.h3,{id:"step-6-restarted-services",children:"Step 6: Restarted Services"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"sudo systemctl restart wazuh-indexer\r\nsudo systemctl restart wazuh-dashboard\r\nsudo systemctl restart wazuh-manager\n"})}),"\n",(0,a.jsx)(s.p,{children:"Confirmed all services started successfully and dashboard became accessible."}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Screenshot dashboard access prompt:"}),(0,a.jsx)(s.br,{}),"\n",(0,a.jsx)(s.img,{alt:"Dashboard Access",src:r(64115).A+"",width:"1606",height:"845"})]}),"\n",(0,a.jsx)(s.h4,{id:"outcome",children:"Outcome"}),"\n",(0,a.jsx)(s.p,{children:"The login issue was resolved by addressing password mismatches, updating the keystore securely, and regenerating SSL certificates with appropriate permissions. Dashboard is now accessible with updated credentials."}),"\n",(0,a.jsx)(s.h4,{id:"appendix",children:"Appendix"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Logs:"})," ",(0,a.jsx)(s.code,{children:"/var/ossec/logs/ossec.log"}),", ",(0,a.jsx)(s.code,{children:"journalctl -xeu wazuh-dashboard.service"})]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Config files:"})," ",(0,a.jsx)(s.code,{children:"/etc/wazuh-dashboard/opensearch_dashboards.yml"}),", ",(0,a.jsx)(s.code,{children:"authentication.json"})]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Tools used:"})," OpenSSL, systemctl, wazuh-passwords-tool"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},91150:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/WFSv1-2-359a201c5e5617d7428c0683bf640c2a.png"},90647:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/WFSv1-3-d9e2aee37e20ea0d6a7cec1dccc6fb12.png"},68504:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/WFSv1-4-ee863b1b9eb1b22b07b5c06e348d88a5.png"},89633:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/WFSv1-5-1a4a79222a972e9ae5b9a84e42032e91.png"},32202:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/WFSv1-6-f5af66f9daf2f8af462b0bedc3b708b7.png"},64115:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/WFSv1-7-b946b38bf8ec69bdf4ed4628f1fe639e.png"},28453:(e,s,r)=>{r.d(s,{R:()=>i,x:()=>d});var n=r(96540);const a={},t=n.createContext(a);function i(e){const s=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(t.Provider,{value:s},e.children)}}}]);