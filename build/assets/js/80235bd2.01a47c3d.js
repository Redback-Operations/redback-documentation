"use strict";(self.webpackChunkredback_documentation=self.webpackChunkredback_documentation||[]).push([[5529],{51763:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"data-warehousing/Restic/restic","title":"restic","description":"Last updated by \'16/05/2025\'","source":"@site/docs/data-warehousing/Restic/restic.md","sourceDirName":"data-warehousing/Restic","slug":"/data-warehousing/Restic/","permalink":"/redback-documentation/docs/data-warehousing/Restic/","draft":false,"unlisted":false,"editUrl":"https://github.com/Redback-Operations/redback-documentation/blob/main/docs/data-warehousing/Restic/restic.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"Restic"},"sidebar":"tutorialSidebar","previous":{"title":"Restic","permalink":"/redback-documentation/docs/category/restic"},"next":{"title":"Web & Mobile App Dev","permalink":"/redback-documentation/docs/category/web--mobile-app-dev"}}');var r=n(74848),i=n(28453);const a={sidebar_position:1,sidebar_label:"Restic"},o="Data Warehouse Restic-Docker Backup System",c={},l=[{value:"Features",id:"features",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setup Instructions",id:"setup-instructions",level:2},{value:"1. Clone the Repository",id:"1-clone-the-repository",level:3},{value:"2. Restic Monitors and Backs Up the Following Volumes",id:"2-restic-monitors-and-backs-up-the-following-volumes",level:3},{value:"3. Configure Restic Password",id:"3-configure-restic-password",level:3},{value:"4. Make Scripts Executable",id:"4-make-scripts-executable",level:3},{value:"Running the Backup System",id:"running-the-backup-system",level:2},{value:"Start the Restic Container",id:"start-the-restic-container",level:3},{value:"Verify the Logs",id:"verify-the-logs",level:3},{value:"Managing Snapshots",id:"managing-snapshots",level:2},{value:"List Available Snapshots",id:"list-available-snapshots",level:3},{value:"Restore a Snapshot",id:"restore-a-snapshot",level:3},{value:"Access Restored Files",id:"access-restored-files",level:3},{value:"Stopping the Backup System",id:"stopping-the-backup-system",level:2},{value:"Notes",id:"notes",level:2},{value:"Resources",id:"resources",level:2}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Last updated by:"})," BeniDage, ",(0,r.jsx)(s.strong,{children:"Last updated on:"})," '16/05/2025'"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Last updated by:"})," BeniDage, ",(0,r.jsx)(s.strong,{children:"Last updated on:"})," '16/05/2025'"]}),"\n",(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"data-warehouse-restic-docker-backup-system",children:"Data Warehouse Restic-Docker Backup System"})}),"\n",(0,r.jsx)(s.admonition,{type:"info",children:(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Document Creation:"})," 15 May 2025. ",(0,r.jsx)(s.strong,{children:"Last Edited:"})," 15 May 2025. ",(0,r.jsx)(s.strong,{children:"Author:"})," Ben Dang.\r\n",(0,r.jsx)("br",{})," ",(0,r.jsx)(s.strong,{children:"Document Code:"})," RES1. ",(0,r.jsx)(s.strong,{children:"Effective Date:"})," 15 May 2025. ",(0,r.jsx)(s.strong,{children:"Expiry Date:"})," 15 May 2026."]})}),"\n",(0,r.jsx)(s.p,{children:"This document sets up a simple and secure backup system using Restic on Docker."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"features",children:"Features"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Automated Backups"}),": Back up multiple Docker volumes using Restic."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Snapshot Management"}),": Easily manage and restore snapshots."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Customizable"}),": Modify the backup script to suit your needs."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Docker"}),": Ensure Docker is installed on your system. ",(0,r.jsx)(s.a,{href:"https://docs.docker.com/get-docker/",children:"Install Docker"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Docker Compose"}),": Ensure Docker Compose is installed. ",(0,r.jsx)(s.a,{href:"https://docs.docker.com/compose/install/",children:"Install Docker Compose"}),"."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"setup-instructions",children:"Setup Instructions"}),"\n",(0,r.jsx)(s.h3,{id:"1-clone-the-repository",children:"1. Clone the Repository"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"git clone https://github.com/Redback-Operations/redback-data-warehouse.git\r\n\r\ncd restic\n"})}),"\n",(0,r.jsx)(s.h3,{id:"2-restic-monitors-and-backs-up-the-following-volumes",children:"2. Restic Monitors and Backs Up the Following Volumes"}),"\n",(0,r.jsx)(s.p,{children:"Restic is configured to back up data from several external Docker volumes on Redback VM. Before running the backup system, make sure these volumes exist."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"data-lakehouse_minio-data\r\ndata-lakehouse_minio-config\r\nfileuploadservice_dremio-data\r\ndp-postgres-data\r\ndp-es-data\r\ndp-logstash-data\n"})}),"\n",(0,r.jsx)(s.p,{children:"Run the following commands to create them:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"docker volume create data-lakehouse_minio-data\r\ndocker volume create data-lakehouse_minio-config\r\ndocker volume create fileuploadservice_dremio-data\r\ndocker volume create dp-postgres-data\r\ndocker volume create dp-es-data\r\ndocker volume create dp-logstash-data\n"})}),"\n",(0,r.jsx)(s.h3,{id:"3-configure-restic-password",children:"3. Configure Restic Password"}),"\n",(0,r.jsxs)(s.p,{children:["Create a ",(0,r.jsx)(s.code,{children:"restic-password.txt"})," file in the project directory and add your Restic repository password:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-plaintext",children:"your-secure-password\n"})}),"\n",(0,r.jsx)(s.h3,{id:"4-make-scripts-executable",children:"4. Make Scripts Executable"}),"\n",(0,r.jsx)(s.p,{children:"Ensure the backup script is executable:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"chmod +x scripts/backup.sh\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"running-the-backup-system",children:"Running the Backup System"}),"\n",(0,r.jsx)(s.h3,{id:"start-the-restic-container",children:"Start the Restic Container"}),"\n",(0,r.jsx)(s.p,{children:"Run the following command to start the Restic container:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"docker-compose up -d\n"})}),"\n",(0,r.jsx)(s.h3,{id:"verify-the-logs",children:"Verify the Logs"}),"\n",(0,r.jsx)(s.p,{children:"Check the logs of the Restic container to ensure backups are running:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"docker logs -f restic-backup\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"managing-snapshots",children:"Managing Snapshots"}),"\n",(0,r.jsx)(s.h3,{id:"list-available-snapshots",children:"List Available Snapshots"}),"\n",(0,r.jsx)(s.p,{children:"To list all available snapshots, run:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"docker exec -it restic-backup sh\n"})}),"\n",(0,r.jsx)(s.h3,{id:"restore-a-snapshot",children:"Restore a Snapshot"}),"\n",(0,r.jsx)(s.p,{children:"To restore a specific snapshot, use the following command:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"restic restore <snapshot-id> --target <target-directory>\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Replace ",(0,r.jsx)(s.code,{children:"<snapshot-id>"})," with the ID of the snapshot you want to restore."]}),"\n",(0,r.jsx)(s.h3,{id:"access-restored-files",children:"Access Restored Files"}),"\n",(0,r.jsxs)(s.p,{children:["The restored files will be available in the ",(0,r.jsx)(s.code,{children:"./restore"})," directory on your host machine."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"stopping-the-backup-system",children:"Stopping the Backup System"}),"\n",(0,r.jsx)(s.p,{children:"To stop the Restic container, run:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"docker-compose down\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"notes",children:"Notes"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Ensure all required volumes are created before starting the container."}),"\n",(0,r.jsxs)(s.li,{children:["Modify the ",(0,r.jsx)(s.code,{children:"backup.sh"})," script to customize the backup process."]}),"\n",(0,r.jsxs)(s.li,{children:["Use ",(0,r.jsx)(s.code,{children:"docker-compose logs"})," to troubleshoot any issues."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"resources",children:"Resources"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://restic.readthedocs.io/",children:"Restic Documentation"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.docker.com/",children:"Docker Documentation"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.docker.com/compose/",children:"Docker Compose Documentation"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>o});var t=n(96540);const r={},i=t.createContext(r);function a(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);