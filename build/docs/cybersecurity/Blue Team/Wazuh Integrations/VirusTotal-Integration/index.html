<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">VirusTotal-Integration | Redback Operations</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://github.com/redback-documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://github.com/redback-documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://github.com/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="VirusTotal-Integration | Redback Operations"><meta data-rh="true" name="description" content="Last updated by &#x27;14/04/2025&#x27;"><meta data-rh="true" property="og:description" content="Last updated by &#x27;14/04/2025&#x27;"><link data-rh="true" rel="icon" href="/redback-documentation/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://github.com/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration"><link data-rh="true" rel="alternate" href="https://github.com/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration" hreflang="x-default"><link rel="stylesheet" href="/redback-documentation/assets/css/styles.24ac416b.css">
<script src="/redback-documentation/assets/js/runtime~main.ad9ebb00.js" defer="defer"></script>
<script src="/redback-documentation/assets/js/main.a5c79969.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/redback-documentation/"><div class="navbar__logo"><img src="/redback-documentation/img/logo.svg" alt="Redback" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/redback-documentation/img/logo.svg" alt="Redback" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Redback</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/redback-documentation/docs/category/onboarding">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Redback-Operations" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/onboarding">Onboarding</a><button aria-label="Expand sidebar category &#x27;Onboarding&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/company-policies">Company Policies</a><button aria-label="Expand sidebar category &#x27;Company Policies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-1">Project 1</a><button aria-label="Expand sidebar category &#x27;Project 1&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-2">Project 2</a><button aria-label="Expand sidebar category &#x27;Project 2&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-3">Project 3</a><button aria-label="Expand sidebar category &#x27;Project 3&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-4">Project 4</a><button aria-label="Expand sidebar category &#x27;Project 4&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-5">Project 5</a><button aria-label="Expand sidebar category &#x27;Project 5&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/redback-documentation/docs/category/cyber-security-team">Cyber Security Team</a><button aria-label="Collapse sidebar category &#x27;Cyber Security Team&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/redback-documentation/docs/category/blue-team">Blue Team</a><button aria-label="Collapse sidebar category &#x27;Blue Team&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/QEMU-RaspberryPi-Simulation-Pi-hole">QEMU-RaspberryPi-Simulation-Pi-hole</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/wazuh">Wazuh</a><button aria-label="Expand sidebar category &#x27;Wazuh&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/Cowrie-Honeypot-Implementation-Guide">Cowrie-Honeypot-Implementation-Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/elf-stack-geoip">elf-stack-geoip</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/pihole-setup">pihole-setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/pi-research">pi-research</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/graylog---wazuh-integration">Graylog - Wazuh Integration</a><button aria-label="Expand sidebar category &#x27;Graylog - Wazuh Integration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/wazuh---misp-integration">Wazuh - MISP Integration</a><button aria-label="Expand sidebar category &#x27;Wazuh - MISP Integration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/cyber-secuirty-awareness-training">Cyber Secuirty Awareness Training</a><button aria-label="Expand sidebar category &#x27;Cyber Secuirty Awareness Training&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/email-infrastructure--security">Email Infrastructure &amp; Security</a><button aria-label="Expand sidebar category &#x27;Email Infrastructure &amp; Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/misp">MISP</a><button aria-label="Expand sidebar category &#x27;MISP&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/incident-documents">Incident Documents</a><button aria-label="Expand sidebar category &#x27;Incident Documents&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/Playbook/Data Theft Incident Response Playbook">Playbook</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration">Wazuh Integrations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration">VirusTotal-Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/ClamAV-Integration">ClamAV-Integration</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/red-team">Red Team</a><button aria-label="Expand sidebar category &#x27;Red Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/secdevops-team">SecDevOps Team</a><button aria-label="Expand sidebar category &#x27;SecDevOps Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/grc-team">GRC Team</a><button aria-label="Expand sidebar category &#x27;GRC Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/infrastrcture-team">Infrastrcture Team</a><button aria-label="Expand sidebar category &#x27;Infrastrcture Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/cyber-security-research">Cyber Security Research</a><button aria-label="Expand sidebar category &#x27;Cyber Security Research&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/redback-documentation/docs/category/cyber-security-guidelines">Archive</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/data-warehousing-team">Data Warehousing Team</a><button aria-label="Expand sidebar category &#x27;Data Warehousing Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/web--mobile-app-dev">Web &amp; Mobile App Dev</a><button aria-label="Expand sidebar category &#x27;Web &amp; Mobile App Dev&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/examples--tutorials">Examples / Tutorials</a><button aria-label="Expand sidebar category &#x27;Examples / Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/documentation-maintenance">Documentation Maintenance</a><button aria-label="Expand sidebar category &#x27;Documentation Maintenance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/redback-documentation/docs/orion-backend/kafkadocs/">orion-backend</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/redback-documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/redback-documentation/docs/category/cyber-security-team"><span itemprop="name">Cyber Security Team</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/redback-documentation/docs/category/blue-team"><span itemprop="name">Blue Team</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Wazuh Integrations</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">VirusTotal-Integration</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><strong>Last updated by:</strong> rspoerl1, <strong>Last updated on:</strong> &#x27;14/04/2025&#x27;</p>
<p><strong>Last updated by:</strong> rspoerl1, <strong>Last updated on:</strong> &#x27;14/04/2025&#x27;</p>
<header><h1>Integrating VirusTotal into Wazuh</h1></header>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p><strong>Document Creation:</strong> 28 Mar, 2025. <strong>Last Edited:</strong> 28 Mar, 2025. <strong>Authors:</strong> Robin Spoerl.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-introduction">1. Introduction<a href="#1-introduction" class="hash-link" aria-label="Direct link to 1. Introduction" title="Direct link to 1. Introduction">​</a></h2>
<p>This document provides a brief overview of VirusTotal and the rationale behind integrating it with Wazuh on Redback Operations&#x27; VM. Additionally, this document will provide step-by-step instructions to show how future users can understand, maintain and improve the integration. It will also describe limitations and future work directions.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-background">2. Background<a href="#2-background" class="hash-link" aria-label="Direct link to 2. Background" title="Direct link to 2. Background">​</a></h2>
<p>Redback Operations currently protects its company VM with a Wazuh SIEM and installed agent. The agent is installed directly on the VM and gathers information about the operating environment. The information is then forwarded to the Wazuh SIEM, which provides an overview of all events tracked by the agent. Currently, apart from the basic rootcheck module, the agent is not configured to check for malicious files, which poses a security risk.</p>
<p>To this end, it is proposed that VirusTotal be integrated within Wazuh&#x27;s FIM (file integrity module). The module can track changes made to key directories in real time, such as written files. If configured, the FIM module can extract the hashes of these written files and forward them to the online VirusTotal service. VirusTotal can look up these hashes and note if they are malicious or benign. This look up information can also be forwarded to the Wazuh SIEM. Thus, this integration allows Wazuh to check if any malicious files were written to an agent&#x27;s system in real time.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-configuration-steps">3. Configuration Steps<a href="#3-configuration-steps" class="hash-link" aria-label="Direct link to 3. Configuration Steps" title="Direct link to 3. Configuration Steps">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-obtain-an-api-key-from-virustotal">3.1. Obtain an API key from VirusTotal<a href="#31-obtain-an-api-key-from-virustotal" class="hash-link" aria-label="Direct link to 3.1. Obtain an API key from VirusTotal" title="Direct link to 3.1. Obtain an API key from VirusTotal">​</a></h3>
<p>First, visit <a href="https://www.virustotal.com/gui/join-us" target="_blank" rel="noopener noreferrer">https://www.virustotal.com/gui/join-us</a> and create a Community account.
<img decoding="async" loading="lazy" alt="Signing up for VirusTotal" src="/redback-documentation/assets/images/signup-f24e1bd303180051047b0e26aec081f6.png" width="537" height="1016" class="img_ev3q"></p>
<p>Press on your profile -&gt; API Key. Copy the key. This key will be used to interact with VirusTotal.
<img decoding="async" loading="lazy" alt="API Key" src="/redback-documentation/assets/images/api-687cf5bd0b2ea413e08fc7092737bebe.png" width="1660" height="282" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-modify-the-wazuh-managers-ossecconf-file">3.2. Modify the Wazuh manager&#x27;s ossec.conf file<a href="#32-modify-the-wazuh-managers-ossecconf-file" class="hash-link" aria-label="Direct link to 3.2. Modify the Wazuh manager&#x27;s ossec.conf file" title="Direct link to 3.2. Modify the Wazuh manager&#x27;s ossec.conf file">​</a></h3>
<p>The Wazuh manager is a part of Wazuh and acts like the server. The manager reads from the <strong>ossec.conf</strong> file, which specifies configuration settings. You need to modify this file to add the API information for VirusTotal.</p>
<p>To find the file, run <code>docker ps</code>. You will see a running instance called <strong>single-node_wazuh.manager_1</strong>.
<img decoding="async" loading="lazy" alt="List of Docker instances" src="/redback-documentation/assets/images/docker_running-5b79fa9f8fdab2e3a3890aba8497c7b4.png" width="610" height="623" class="img_ev3q"></p>
<p>Inspect this instance using <code>docker inspect single-node_wazuh.manager_1</code>. Note the presence of <strong>ossec.conf</strong>. In fact, <strong>ossec.conf</strong> is a file stored inside the respective Docker instance. If you were to go into the Docker instance and modify the file directly, whenever the Docker instance restarts all progress would be lost. Instead, to achieve data persistence, these files are mapped to files outside of the containers. Modifying these mapped files ensures that no data is lost when the containers are restarted. In this case, the manager&#x27;s <strong>ossec.conf</strong> file is mapped to <strong>wazuh_manager.conf</strong>. So, you need to modify this file instead.
<img decoding="async" loading="lazy" alt="Volumes" src="/redback-documentation/assets/images/inspect_process-d66bab1985eaccc285f77cb29ff1891e.png" width="1220" height="364" class="img_ev3q"></p>
<p>Open the file using any editor (you will need higher privileges for this) and add the following code block:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">&lt;integration&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  &lt;name&gt;virustotal&lt;/name&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  &lt;api_key&gt;&lt;VIRUSTOTAL_API_KEY&gt;&lt;/api_key&gt; &lt;!-- Replace with your VirusTotal API key --&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  &lt;group&gt;syscheck&lt;/group&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  &lt;alert_format&gt;json&lt;/alert_format&gt;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">&lt;/integration&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>See the example screenshot. Since this resource is publicly available, half of the API key has been blurred out.
<img decoding="async" loading="lazy" alt="Adding the API key" src="/redback-documentation/assets/images/adding_api-dea9d4e4cc20845d1436992615ba425e.png" width="1201" height="132" class="img_ev3q"></p>
<p>Save your changes and restart the manager container.
<img decoding="async" loading="lazy" alt="Restarting Docker instance" src="/redback-documentation/assets/images/restart_manager-e3d38f805955181227a4b5275c93623c.png" width="1033" height="71" class="img_ev3q"></p>
<p>On the Wazuh dashboard, an option for VirusTotal will show up now.
<img decoding="async" loading="lazy" alt="Wazuh dashboard status" src="/redback-documentation/assets/images/dashboard_status-60c48a4cd3c6939dcd979b6966fceb41.png" width="1415" height="549" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-change-the-agents-fim-settings">3.3. Change the agent&#x27;s FIM settings<a href="#33-change-the-agents-fim-settings" class="hash-link" aria-label="Direct link to 3.3. Change the agent&#x27;s FIM settings" title="Direct link to 3.3. Change the agent&#x27;s FIM settings">​</a></h3>
<p>Now that the manager has been set up with VirusTotal, you need to modify the FIM settings to perform real-time scanning on a specified number of directories. By default, FIM performs a full system scan with several default system directories every 12 hours, but this is not ideal. To modify this, you need to access the <strong>ossec.conf</strong> file of the <strong>agent</strong>, NOT the <strong>manager</strong>. The agent file is by default stored under <strong>/var/ossec/etc</strong> in the agent&#x27;s system. You need elevated privileges to access this file.
<img decoding="async" loading="lazy" alt="Configuration directory of the agent" src="/redback-documentation/assets/images/agent_etc_directory-3091170d46c9570d912e83bbda6d7a44.png" width="1278" height="62" class="img_ev3q"></p>
<p>Once there, you can choose any directories to monitor. However, due to API limitations, these must be directories that are not very active. For example, since the Data Warehouse&#x27;s file upload tool uses the <strong>dw-bucket-bronze</strong> directory, it is useful to monitor this directory in case a malicious file gets uploaded. While Deakin seems to have an IPS installed that detects malicious uploads on its network, it is valuable regardless to monitor this directory as an extra layer of security.</p>
<p>Finally, the  <strong>/usr/bin</strong> and <strong>/usr/sbin</strong> directories store important system and user binaries. It would be valuable to monitor these.</p>
<p>Add the following code block to the <strong>syscheck</strong> section:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">&lt;directories check_all=&quot;yes&quot; realtime=&quot;yes&quot;&gt;/usr/bin, /usr/sbin, /var/lib/docker/volumes/data-lakehouse_minio-data/_data/dw-bucket-bronze&lt;/directories&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>check_all</strong> ensures that all important information is extracted from any files written to these directories, including their hashes. <strong>realtime</strong> ensures that these directories are always monitored. Note that you can modify these directories as needed.</p>
<p>See the example screenshot.
<img decoding="async" loading="lazy" alt="Agent configuration file" src="/redback-documentation/assets/images/agent_config-a2a596fc32b4f307af6375b9c0a7e9f5.png" width="1405" height="134" class="img_ev3q"></p>
<p>Note in the previous screenshot the second line containing critical system files like <strong>/etc/passwd</strong> and <strong>/etc/shadow</strong>. While not entirely related to VirusTotal integration, these files and directories were added to the real-time checking module, away from the default 12-hour checks. The rationale behind this was that these files and directories contain critical information that, when modified, could be indicative of an attack.</p>
<p>Save your changes and restart the wazuh-agent process.
<img decoding="async" loading="lazy" alt="Restarting the Wazuh agent" src="data:image/png;base64,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" width="561" height="50" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-test-virustotal-integration">3.4. Test VirusTotal integration<a href="#34-test-virustotal-integration" class="hash-link" aria-label="Direct link to 3.4. Test VirusTotal integration" title="Direct link to 3.4. Test VirusTotal integration">​</a></h3>
<p>You can write files to monitored directories and see corresponding alerts appear in both the FIM and VirusTotal modules. As an example, assume that you have modified the previous <strong>sysconfig</strong> block to monitor the non-critical <strong>/tmp</strong> and <strong>/var/tmp</strong> directories. While VirusTotal integration would not work well on these directories on an ongoing basis, they are good starting points nonetheless to try out the FIM without damaging anything. The actual company implementation does NOT monitor these directories.</p>
<p>To demonstrate the monitoring, &quot;tst.txt&quot; files were written to the non-critical <strong>/tmp</strong> and <strong>/var/tmp</strong> directories. The hashes of the files were extracted by FIM and sent to VirusTotal, which had no results.<br>
<img decoding="async" loading="lazy" alt="FIM" src="/redback-documentation/assets/images/FIM-33c4d117130d29c932ddf93544489c93.png" width="2035" height="177" class="img_ev3q">
<img decoding="async" loading="lazy" alt="VirusTotal" src="/redback-documentation/assets/images/virustotal_dashboard-c8caaee271a5eb3ffe16884aad3c5436.png" width="2182" height="176" class="img_ev3q"></p>
<p>Moreover, you can also test the VirusTotal integration using malicious files such as EICAR. EICAR is a &quot;safe&quot; malicious file used to test basic anti-virus capabilities. First, download the file in any monitored directory.
<img decoding="async" loading="lazy" alt="Downloading Eicar" src="/redback-documentation/assets/images/download_eicar-e30f810aa9a0b105dc7286c039e772bc.png" width="773" height="80" class="img_ev3q"></p>
<p>Note the corresponding warning on the VirusTotal tab, with a label (&quot;1&quot;) noting that the file is malicious. There is also a corresponding link which describes the file in more detail.
<img decoding="async" loading="lazy" alt="VirusTotal warning" src="/redback-documentation/assets/images/eicar_virustotal_warning-8c7888f69eb07be1637354205787fa45.png" width="2428" height="110" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-limitations">3.5. Limitations<a href="#35-limitations" class="hash-link" aria-label="Direct link to 3.5. Limitations" title="Direct link to 3.5. Limitations">​</a></h3>
<p>The tool was implemented using the Public API, which is limited to 500 requests per day and 4 requests per minute. Thus, VirusTotal cannot be used for system-wide monitoring. Likewise, the Public API is severely limited to directories which do have a lot of recurring file modifications. While this is useful for, say, the internal file upload tool, it also means that popular malware directories like <strong>/tmp</strong> cannot be effectively monitored. Consequently, future work will need to focus on tools that do not rely on APIs, like YARA and ClamAV, to complement this hash-based approach.</p>
<p>In addition, the tool uses hashes to detect uploaded malware samples. Yet, these hashes are limited to known malware samples. If an attacker were to apply an obfuscation or modification technique to an existing sample, which they have not applied elsewhere, VirusTotal would likely not detect the sample. Thus, while this integration enhances a defence-in-depth strategy, it should not be relied upon as the sole security measure.</p>
<p>Finally, the Public API is forbidden to be used in a commercial setting. Hence, if Redback Operations were to move to a commercial setting in the future, they would need to investigate the Premium API or other options.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-references">4. References<a href="#4-references" class="hash-link" aria-label="Direct link to 4. References" title="Direct link to 4. References">​</a></h2>
<ul>
<li><a href="https://documentation.wazuh.com/current/user-manual/capabilities/malware-detection/virus-total-integration.html" target="_blank" rel="noopener noreferrer">VirusTotal Integration Wazuh Guide</a></li>
<li><a href="https://www.eicar.org/download-anti-malware-testfile/" target="_blank" rel="noopener noreferrer">EICAR</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Redback-Operations/redback-documentation/blob/main/docs/cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/redback-documentation/docs/cybersecurity/Blue Team/Playbook/Threat hunting and incidnet response playbook"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Threat hunting and incidnet response playbook</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/ClamAV-Integration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ClamAV-Integration</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-introduction" class="table-of-contents__link toc-highlight">1. Introduction</a></li><li><a href="#2-background" class="table-of-contents__link toc-highlight">2. Background</a></li><li><a href="#3-configuration-steps" class="table-of-contents__link toc-highlight">3. Configuration Steps</a><ul><li><a href="#31-obtain-an-api-key-from-virustotal" class="table-of-contents__link toc-highlight">3.1. Obtain an API key from VirusTotal</a></li><li><a href="#32-modify-the-wazuh-managers-ossecconf-file" class="table-of-contents__link toc-highlight">3.2. Modify the Wazuh manager&#39;s ossec.conf file</a></li><li><a href="#33-change-the-agents-fim-settings" class="table-of-contents__link toc-highlight">3.3. Change the agent&#39;s FIM settings</a></li><li><a href="#34-test-virustotal-integration" class="table-of-contents__link toc-highlight">3.4. Test VirusTotal integration</a></li><li><a href="#35-limitations" class="table-of-contents__link toc-highlight">3.5. Limitations</a></li></ul></li><li><a href="#4-references" class="table-of-contents__link toc-highlight">4. References</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Info</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/redback-documentation/docs/category/onboarding">Docs</a></li><li class="footer__item"><a href="https://github.com/Redback-Operations" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Redback Operations</div></div></div></footer></div>
</body>
</html>