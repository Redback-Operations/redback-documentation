<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cybersecurity/Blue Team/Wazuh Integrations/ClamAV-Integration" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">ClamAV-Integration | Redback Operations</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://github.com/redback-documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://github.com/redback-documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://github.com/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/ClamAV-Integration"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ClamAV-Integration | Redback Operations"><meta data-rh="true" name="description" content="Last updated by &#x27;14/04/2025&#x27;"><meta data-rh="true" property="og:description" content="Last updated by &#x27;14/04/2025&#x27;"><link data-rh="true" rel="icon" href="/redback-documentation/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://github.com/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/ClamAV-Integration"><link data-rh="true" rel="alternate" href="https://github.com/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/ClamAV-Integration" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/ClamAV-Integration" hreflang="x-default"><link rel="stylesheet" href="/redback-documentation/assets/css/styles.24ac416b.css">
<script src="/redback-documentation/assets/js/runtime~main.ad9ebb00.js" defer="defer"></script>
<script src="/redback-documentation/assets/js/main.a5c79969.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/redback-documentation/"><div class="navbar__logo"><img src="/redback-documentation/img/logo.svg" alt="Redback" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/redback-documentation/img/logo.svg" alt="Redback" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Redback</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/redback-documentation/docs/category/onboarding">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Redback-Operations" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/onboarding">Onboarding</a><button aria-label="Expand sidebar category &#x27;Onboarding&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/company-policies">Company Policies</a><button aria-label="Expand sidebar category &#x27;Company Policies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-1">Project 1</a><button aria-label="Expand sidebar category &#x27;Project 1&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-2">Project 2</a><button aria-label="Expand sidebar category &#x27;Project 2&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-3">Project 3</a><button aria-label="Expand sidebar category &#x27;Project 3&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-4">Project 4</a><button aria-label="Expand sidebar category &#x27;Project 4&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-5">Project 5</a><button aria-label="Expand sidebar category &#x27;Project 5&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/redback-documentation/docs/category/cyber-security-team">Cyber Security Team</a><button aria-label="Collapse sidebar category &#x27;Cyber Security Team&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/redback-documentation/docs/category/blue-team">Blue Team</a><button aria-label="Collapse sidebar category &#x27;Blue Team&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/QEMU-RaspberryPi-Simulation-Pi-hole">QEMU-RaspberryPi-Simulation-Pi-hole</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/wazuh">Wazuh</a><button aria-label="Expand sidebar category &#x27;Wazuh&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/Cowrie-Honeypot-Implementation-Guide">Cowrie-Honeypot-Implementation-Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/elf-stack-geoip">elf-stack-geoip</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/pihole-setup">pihole-setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/pi-research">pi-research</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/graylog---wazuh-integration">Graylog - Wazuh Integration</a><button aria-label="Expand sidebar category &#x27;Graylog - Wazuh Integration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/wazuh---misp-integration">Wazuh - MISP Integration</a><button aria-label="Expand sidebar category &#x27;Wazuh - MISP Integration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/cyber-secuirty-awareness-training">Cyber Secuirty Awareness Training</a><button aria-label="Expand sidebar category &#x27;Cyber Secuirty Awareness Training&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/email-infrastructure--security">Email Infrastructure &amp; Security</a><button aria-label="Expand sidebar category &#x27;Email Infrastructure &amp; Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/misp">MISP</a><button aria-label="Expand sidebar category &#x27;MISP&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/incident-documents">Incident Documents</a><button aria-label="Expand sidebar category &#x27;Incident Documents&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/Playbook/Data Theft Incident Response Playbook">Playbook</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration">Wazuh Integrations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration">VirusTotal-Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/ClamAV-Integration">ClamAV-Integration</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/red-team">Red Team</a><button aria-label="Expand sidebar category &#x27;Red Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/secdevops-team">SecDevOps Team</a><button aria-label="Expand sidebar category &#x27;SecDevOps Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/grc-team">GRC Team</a><button aria-label="Expand sidebar category &#x27;GRC Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/infrastrcture-team">Infrastrcture Team</a><button aria-label="Expand sidebar category &#x27;Infrastrcture Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/cyber-security-research">Cyber Security Research</a><button aria-label="Expand sidebar category &#x27;Cyber Security Research&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/redback-documentation/docs/category/cyber-security-guidelines">Archive</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/data-warehousing-team">Data Warehousing Team</a><button aria-label="Expand sidebar category &#x27;Data Warehousing Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/web--mobile-app-dev">Web &amp; Mobile App Dev</a><button aria-label="Expand sidebar category &#x27;Web &amp; Mobile App Dev&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/examples--tutorials">Examples / Tutorials</a><button aria-label="Expand sidebar category &#x27;Examples / Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/documentation-maintenance">Documentation Maintenance</a><button aria-label="Expand sidebar category &#x27;Documentation Maintenance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/redback-documentation/docs/orion-backend/kafkadocs/">orion-backend</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/redback-documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/redback-documentation/docs/category/cyber-security-team"><span itemprop="name">Cyber Security Team</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/redback-documentation/docs/category/blue-team"><span itemprop="name">Blue Team</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Wazuh Integrations</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ClamAV-Integration</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><strong>Last updated by:</strong> rspoerl1, <strong>Last updated on:</strong> &#x27;14/04/2025&#x27;</p>
<p><strong>Last updated by:</strong> rspoerl1, <strong>Last updated on:</strong> &#x27;14/04/2025&#x27;</p>
<header><h1>ClamAV and Wazuh Integration</h1></header>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p><strong>Document Creation:</strong> 14 Apr., 2025. <strong>Last Edited:</strong> 14 Apr., 2025. <strong>Authors:</strong> Robin Spoerl.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-introduction">1. Introduction<a href="#1-introduction" class="hash-link" aria-label="Direct link to 1. Introduction" title="Direct link to 1. Introduction">​</a></h2>
<p>This document provides a brief overview of ClamAV and the rationale behind integrating it with Wazuh on Redback Operations&#x27; VM. Additionally, this document will provide step-by-step instructions to show how future users can understand, maintain and improve the integration. It will also describe limitations and future work directions.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-background">2. Background<a href="#2-background" class="hash-link" aria-label="Direct link to 2. Background" title="Direct link to 2. Background">​</a></h2>
<p>Redback Operations currently lacks a comprehensive malware detection solution for its virtualised environment. Given that numerous web applications store files on the virtual machine, and remote users can access and download files, a lack of malware detection presents some security concerns.</p>
<p>In previous work, VirusTotal and Wazuh integration was investigated with a focus on monitoring key system directories. However, due to API limitations, this solution is incompatible as a widespread solution for Redback Operations&#x27; environment. Consequently, research was done on other alternatives, such as ClamAV.</p>
<p>ClamAV is a popular open-source anti-malware solution for Linux and Windows systems. It uses a large signature database maintained by Cisco to detect threats. ClamAV can also perform system-wide scanning without any API restrictions, making it a suitable alternative to VirusTotal. Finally, ClamAV logs can easily be parsed by Wazuh, meaning that anti-virus alerts can be monitored through the Wazuh dashboard.</p>
<p>Alternatives to ClamAV were explored. Nevertheless, the range of anti-malware solutions for Linux is small, and most require a paid subscription (e.g. Sophos Protection for Linux). Since ClamAV is the most popular solution, and supports easy integration with Wazuh, ClamAV is the most appropriate solution to investigate.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-proposal">3. Proposal<a href="#3-proposal" class="hash-link" aria-label="Direct link to 3. Proposal" title="Direct link to 3. Proposal">​</a></h2>
<p>For security reasons, it is proposed that ClamAV be deployed via a Docker container. To ensure that no data can be modified, key directories will be mounted with read-only access. Moreover, this avoids dependency issues with applications running on the VM.</p>
<p>In terms of scanning, active scanning (real-time monitoring) of key directories was investigated. However, this is incompatible with the Docker architecture and would involve giving ClamAV root permissions, which is a security issue. Moreover, the performance of the VM would be negatively impacted. As such, instead, ClamAV will be set up to perform recurring system scanning on key directories every 12 hours. This functionality can be implemented easily using Cronjobs.</p>
<p>The remainder of this document will describe exactly how ClamAV can be set up.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-configuration-steps">4. Configuration Steps<a href="#4-configuration-steps" class="hash-link" aria-label="Direct link to 4. Configuration Steps" title="Direct link to 4. Configuration Steps">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-installing-clamav-docker-container">4.1. Installing ClamAV Docker Container<a href="#41-installing-clamav-docker-container" class="hash-link" aria-label="Direct link to 4.1. Installing ClamAV Docker Container" title="Direct link to 4.1. Installing ClamAV Docker Container">​</a></h3>
<p>Pull the official latest container using <code>docker pull clamav/clamav:latest_base</code>. This version does not come pre-installed with a virus database. Instead, it is expected that the virus database is persisted on the host machine via a volume. That way, every time you run the container, you do not have to download the database. When the container runs, it will automatically install the virus database.</p>
<p><img decoding="async" loading="lazy" alt="Pulling Docker container" src="/redback-documentation/assets/images/pulling_clamav_container-e8301b54d94cc32c779bf0153948a92d.png" width="754" height="216" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-creating-persistent-volumes">4.2. Creating Persistent Volumes<a href="#42-creating-persistent-volumes" class="hash-link" aria-label="Direct link to 4.2. Creating Persistent Volumes" title="Direct link to 4.2. Creating Persistent Volumes">​</a></h3>
<p>Create a volume for the virus database, using <code>docker volume create clam_db</code>. Create a volume for the ClamAV configuration files too.</p>
<p><img decoding="async" loading="lazy" alt="Database volume" src="data:image/png;base64,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" width="443" height="45" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Config volume" src="data:image/png;base64,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" width="470" height="45" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-identifying-writable-directories">4.3. Identifying Writable Directories<a href="#43-identifying-writable-directories" class="hash-link" aria-label="Direct link to 4.3. Identifying Writable Directories" title="Direct link to 4.3. Identifying Writable Directories">​</a></h3>
<p>Before starting the ClamAV container, you need to identify which directories you want to monitor. A simple way of doing this is looking for all user-writable (non-root) directories. Use the command <code>find / -writable -type d 2&gt;&amp;1 | grep -v &quot;Permission denied&quot;</code>. Here is a preview of some results you will see.</p>
<p><img decoding="async" loading="lazy" alt="Writable directories" src="/redback-documentation/assets/images/writable_directories-91918920116ff41eacd9b713046c546c.png" width="768" height="122" class="img_ev3q"></p>
<p>After parsing through the results, you will see many directories that are not unique to your user. These are /dev/mqueue, /dev/shm, /var/crash, /run/screen, and /run/lock. There are also common examples like /var/tmp, /tmp, and /home (this is the users&#x27; directory). Finally, you also want to monitor the volumes directory where all the container data is stored (such as the Streamlit file upload web app). This is at /var/lib/docker/volumes. With the exception of the volumes directory, the goal is to monitor all non-root directories where normal users can write files to, and perhaps hide payloads. Moreover, it also avoids performing a full-system scan, which would take up many resources.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-starting-the-container">4.4. Starting the Container<a href="#44-starting-the-container" class="hash-link" aria-label="Direct link to 4.4. Starting the Container" title="Direct link to 4.4. Starting the Container">​</a></h3>
<p>Before using Cronjobs to automate the scanning process, let us demonstrate how you can start up the container manually. Here is the code:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">docker run -d --rm \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --name &quot;clam_container_01&quot; \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --log-driver=syslog \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --log-opt tag=&quot;clamd&quot; \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount source=clam_db,target=/var/lib/clamav \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount source=clam_conf,target=/etc/clamav \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount type=bind,source=/home,target=/to_scan/home,readonly \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount type=bind,source=/var/tmp,target=/to_scan/var/tmp,readonly \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount type=bind,source=/tmp,target=/to_scan/tmp,readonly \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount type=bind,source=/var/lib/php/sessions,target=/to_scan/var/lib/php/sessions,readonly \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount type=bind,source=/var/crash,target=/to_scan/var/crash,readonly \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount type=bind,source=/run/screen,target=/to_scan/run/screen,readonly \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount type=bind,source=/run/lock,target=/to_scan/run/lock,readonly \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount type=bind,source=/dev/mqueue,target=/to_scan/dev/mqueue,readonly \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount type=bind,source=/dev/shm,target=/to_scan/dev/shm,readonly \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  --mount type=bind,source=/var/lib/docker/volumes,target=/to_scan/var/lib/docker/volumes,readonly \</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  clamav/clamav:latest_base</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The -d flag starts the container as a background process, and --rm removes the container in case it is stopped (to avoid having lingering containers stored with the same name). The --log-driver parameter ensures that the container&#x27;s internal logs are stored and parsed via the host&#x27;s syslog process. This is used to capture the ClamAV virus scans and save them on the host. Then, --log-opt sets the program logs of the container to be &quot;clamd&quot;. This ensures that logs coming from the container are called &quot;clamd&quot;, which is needed for the Wazuh decoders.</p>
<p>As mentioned before, we mount the volumes against the database and configuration directories of the container. We also explicitly mount each of the target directories into a subdirectory of /to_scan in the container as readonly. This way, internally, ClamAV can access the directories and only scan them.</p>
<p><img decoding="async" loading="lazy" alt="Starting the container" src="/redback-documentation/assets/images/starting_clamav_container-4567e056827f7317b6cee17cb1378839.png" width="997" height="346" class="img_ev3q"></p>
<blockquote>
<p><strong>Note</strong>:
You need to modify the clam.conf file under /var/lib/docker/volumes/clam_conf/_data/ and increase the MaxDirectoryRecursion variable to 20. Otherwise, you will experience scanning errors when running ClamAV.</p>
</blockquote>
<p><img decoding="async" loading="lazy" alt="Modifying the directory recursion variable" src="data:image/png;base64,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" width="430" height="84" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="45-performing-basic-scanning">4.5. Performing Basic Scanning<a href="#45-performing-basic-scanning" class="hash-link" aria-label="Direct link to 4.5. Performing Basic Scanning" title="Direct link to 4.5. Performing Basic Scanning">​</a></h3>
<p>After starting the container, there are two ways to perform scanning: with clamscan or clamdscan. The first option, clamscan, works independently from the clamd daemon and loads the virus database on its own. On the other hand, clamdscan relies on the clamd daemon to load the virus database and perform faster scanning. Moreover, clamdscan supports multi-threaded scanning. Since we are starting the container, which already runs clamd, it makes more sense to run clamdscan.</p>
<blockquote>
<p><strong>Note</strong>: clamd takes about 20 seconds to start up, once the container is started. You need to wait this period BEFORE running clamdscan, or else the tool will not work.</p>
</blockquote>
<p>For a basic scan, run <code>docker exec container_name clamdscan --fdpass /directory</code>. For a more concrete example, see the below screenshot. We use --fdpass to pass in the file descriptors for privileged files (thus avoiding privilege errors) and, for a quick example, we pass in the /to_scan/var/tmp directory, which is mapped to the host&#x27;s /var/tmp directory. This has an EICAR executable in it. Note that by default, clamdscan performs recursive scanning, so you only need to pass in a top-level directory.</p>
<p>You will see a virus detected message. This message, via the syslog driver, will be sent to the host journald service, which Wazuh automatically monitors.</p>
<p><img decoding="async" loading="lazy" alt="Basic scan" src="/redback-documentation/assets/images/clamav_basic_scan-9738c0fefdf9ba41cf14288501228227.png" width="884" height="47" class="img_ev3q"></p>
<p>Over on the Wazuh Threat Hunting dashboard, we can see the corresponding alert.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/redback-documentation/assets/images/virus_detected_dashboard-3a989aaa067a9bb0d2f84d492030d1ec.png" width="1994" height="759" class="img_ev3q">
<img decoding="async" loading="lazy" alt="alt text" src="/redback-documentation/assets/images/virus_detected_log-586e4f423ff1603c664bf08f01adaf2c.png" width="1174" height="616" class="img_ev3q"></p>
<p>However, beyond the virus alert, there are also other ClamAV alerts mistakenly marked as virus alerts, when they are just for normal container stdout messages. This requires the decoder to be refined.</p>
<p><img decoding="async" loading="lazy" alt="Wazuh ClamAV Spam" src="/redback-documentation/assets/images/wazuh_clamav_spam-0614431e0673c79d38f0a88c983d7bf1.png" width="1123" height="610" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="46-refining-the-clamav-decoder">4.6. Refining the ClamAV Decoder<a href="#46-refining-the-clamav-decoder" class="hash-link" aria-label="Direct link to 4.6. Refining the ClamAV Decoder" title="Direct link to 4.6. Refining the ClamAV Decoder">​</a></h3>
<p>Note that earlier, we created the Docker container using the &quot;syslog&quot; plugin, and the name of &quot;clamd&quot;. Since we are using a container architecture, the syslog logs would usually have the program name tied to the container ID, instead of &quot;clamd&quot;. The decoder that Wazuh uses for ClamAV only monitors logs that have the &quot;clamd&quot; program name attached to them. Hence, we had to add the &quot;clamd&quot; name to the container.</p>
<p>One unintended consequence of this, however, is that all logs from the container get marked as from &quot;clamd&quot;, even those that do not show any anti-virus scan logs. Thus, you are seeing those logs pop up in the Wazuh dashboard.</p>
<p>See the decoder below, available under /var/ossec/ruleset/decoders/0075-clamav_decoders.xml in the Wazuh manager container. Note that it parses logs with the program name &quot;clamd&quot;, and the child decoder further matches lines with the &quot;FOUND&quot; string, case insensitive. Now, note from the previous detection logs that they always had a &quot;FOUND&quot; string in capslock. Hence, if we modified this decoder to instead look for case sensitive &quot;FOUND&quot; strings, we could just filter out the detection logs.</p>
<p><img decoding="async" loading="lazy" alt="Original ClamAV decoder" src="/redback-documentation/assets/images/clamav_decoder_original-1a20cf9957909d5dd12c31361f6580ff.png" width="1224" height="651" class="img_ev3q"></p>
<p>Following through with that logic, we will create a custom decoder file. Copy the contents of 0075-clamav_decoders.xml into the /var/lib/docker/volumes/single-node_wazuh_etc/_data/decoders directory on the host. Note the additional new line. This uses PCRE2 to match the FOUND string, case sensitive.</p>
<p><img decoding="async" loading="lazy" alt="New ClamAV decoder" src="/redback-documentation/assets/images/clamav_decoder_new-694ae3726a988d44d442cfc490e99f66.png" width="1257" height="677" class="img_ev3q"></p>
<p>Then, we need to make the Wazuh Manager use this decoder instead of the old one. Modify the wazuh_manager.conf file of the server at /home/ben/wazuh-docker/single-node/config/wazuh_cluster/wazuh_manager.conf. Add the highlighted exclusion line and restart the Wazuh Manager container. Afterwards, you should only see virus alert notifications on the Wazuh dashboard.</p>
<p><img decoding="async" loading="lazy" alt="Excluding the old decoder" src="/redback-documentation/assets/images/exclude_old_decoder-f8ed288bd056045304df83e8aa3f613b.png" width="742" height="279" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="47-automated-scanning">4.7. Automated Scanning<a href="#47-automated-scanning" class="hash-link" aria-label="Direct link to 4.7. Automated Scanning" title="Direct link to 4.7. Automated Scanning">​</a></h3>
<p>After setting everything up, you can manually scan files and directories for malware. To automate this process, you can create a Cronjob to automatically execute a script every, say, 12 hours.</p>
<p>Here is a script you can use. It checks if the ClamAV container exists and stops it if necessary. Then, it executes the previous Docker command, and waits 20 seconds for the container to start up. Then, it runs clamdscan with the -w and -m parameters on the entire scanning directory. The -w parameter ensures that clamdscan waits up to 30 seconds in case the container has not started up, while -m enables multi-threaded scanning. The script stops the container after it has run to avoid using up resources.</p>
<p>Note that every time the container is started, it will check for an updated signature database.</p>
<p><img decoding="async" loading="lazy" alt="Script to start the container" src="/redback-documentation/assets/images/container_script-be4dbc8d6da208367b16c2090c19f702.png" width="1028" height="698" class="img_ev3q"></p>
<p>Using <code>crontab -e</code>, create a new Cronjob that runs the script every 12 hours.
<img decoding="async" loading="lazy" alt="Creating a Cronjob" src="/redback-documentation/assets/images/clamav_cronjob-26408dd21035973f160ad914eb8767f9.png" width="638" height="134" class="img_ev3q"></p>
<blockquote>
<p>⚠️ <strong>Warning</strong>: you need to regularly check the scan results to ensure that the logs of ClamAV are being processed.
If they are not being processed for some reason, restart the Wazuh agent.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-final-thoughts">5. Final Thoughts<a href="#5-final-thoughts" class="hash-link" aria-label="Direct link to 5. Final Thoughts" title="Direct link to 5. Final Thoughts">​</a></h2>
<p>In this guide, we successfully implemented ClamAV across the company VM&#x27;s critical directories. However, there are some considerations that could be included in future work.</p>
<p>On Linux, ClamAV is limited to file scanning, using features like heuristics and signatures. Unlike the Windows version, it cannot perform memory scanning in Linux. Thus, malware that resides in memory will not be detected by ClamAV. Future work should explore memory scanning tools and techniques, in particular Wazuh, which can, as an example, detect injection attacks (<a href="https://wazuh.com/blog/detecting-process-injection-attacks-with-wazuh/" target="_blank" rel="noopener noreferrer">https://wazuh.com/blog/detecting-process-injection-attacks-with-wazuh/</a>).</p>
<p>Moreover, during this task, YARA and ClamAV integration was explored. However, it appears that YARA rules can only be passed invidually to ClamAV&#x27;s scanning tools. Hence, YARA and ClamAV integration is limited to searching for individual malware strains. On the other hand, however, YARA can be integrated with Wazuh scripts to perform matching for monitored directories. YARA and Wazuh integration should be explored by future teams to enhance the ClamAV solution.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-references">6. References<a href="#6-references" class="hash-link" aria-label="Direct link to 6. References" title="Direct link to 6. References">​</a></h2>
<ul>
<li><a href="https://docs.clamav.net/manual/Installing/Docker.html" target="_blank" rel="noopener noreferrer">Installing ClamAV via Docker</a></li>
<li><a href="https://docs.clamav.net/manual/Usage/Scanning.html" target="_blank" rel="noopener noreferrer">ClamAV scanning options</a></li>
<li><a href="https://docs.docker.com/engine/logging/drivers/syslog/" target="_blank" rel="noopener noreferrer">Syslog Docker driver</a></li>
<li><a href="https://documentation.wazuh.com/current/user-manual/ruleset/decoders/custom.html" target="_blank" rel="noopener noreferrer">Adding custom decoders</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Redback-Operations/redback-documentation/blob/main/docs/cybersecurity/Blue Team/Wazuh Integrations/ClamAV-Integration.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/redback-documentation/docs/cybersecurity/Blue Team/Wazuh Integrations/VirusTotal-Integration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">VirusTotal-Integration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/redback-documentation/docs/category/red-team"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Red Team</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-introduction" class="table-of-contents__link toc-highlight">1. Introduction</a></li><li><a href="#2-background" class="table-of-contents__link toc-highlight">2. Background</a></li><li><a href="#3-proposal" class="table-of-contents__link toc-highlight">3. Proposal</a></li><li><a href="#4-configuration-steps" class="table-of-contents__link toc-highlight">4. Configuration Steps</a><ul><li><a href="#41-installing-clamav-docker-container" class="table-of-contents__link toc-highlight">4.1. Installing ClamAV Docker Container</a></li><li><a href="#42-creating-persistent-volumes" class="table-of-contents__link toc-highlight">4.2. Creating Persistent Volumes</a></li><li><a href="#43-identifying-writable-directories" class="table-of-contents__link toc-highlight">4.3. Identifying Writable Directories</a></li><li><a href="#44-starting-the-container" class="table-of-contents__link toc-highlight">4.4. Starting the Container</a></li><li><a href="#45-performing-basic-scanning" class="table-of-contents__link toc-highlight">4.5. Performing Basic Scanning</a></li><li><a href="#46-refining-the-clamav-decoder" class="table-of-contents__link toc-highlight">4.6. Refining the ClamAV Decoder</a></li><li><a href="#47-automated-scanning" class="table-of-contents__link toc-highlight">4.7. Automated Scanning</a></li></ul></li><li><a href="#5-final-thoughts" class="table-of-contents__link toc-highlight">5. Final Thoughts</a></li><li><a href="#6-references" class="table-of-contents__link toc-highlight">6. References</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Info</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/redback-documentation/docs/category/onboarding">Docs</a></li><li class="footer__item"><a href="https://github.com/Redback-Operations" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Redback Operations</div></div></div></footer></div>
</body>
</html>