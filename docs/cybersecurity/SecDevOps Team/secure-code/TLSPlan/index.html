<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cybersecurity/SecDevOps Team/secure-code/TLSPlan" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">TLSPlan | Redback Operations</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://github.com/redback-documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://github.com/redback-documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://github.com/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/TLSPlan"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="TLSPlan | Redback Operations"><meta data-rh="true" name="description" content="Last updated by &#x27;03/12/2024&#x27;"><meta data-rh="true" property="og:description" content="Last updated by &#x27;03/12/2024&#x27;"><link data-rh="true" rel="icon" href="/redback-documentation/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://github.com/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/TLSPlan"><link data-rh="true" rel="alternate" href="https://github.com/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/TLSPlan" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/TLSPlan" hreflang="x-default"><link rel="stylesheet" href="/redback-documentation/assets/css/styles.24ac416b.css">
<script src="/redback-documentation/assets/js/runtime~main.ad9ebb00.js" defer="defer"></script>
<script src="/redback-documentation/assets/js/main.a5c79969.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/redback-documentation/"><div class="navbar__logo"><img src="/redback-documentation/img/logo.svg" alt="Redback" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/redback-documentation/img/logo.svg" alt="Redback" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Redback</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/redback-documentation/docs/category/onboarding">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Redback-Operations" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/onboarding">Onboarding</a><button aria-label="Expand sidebar category &#x27;Onboarding&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/company-policies">Company Policies</a><button aria-label="Expand sidebar category &#x27;Company Policies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-1">Project 1</a><button aria-label="Expand sidebar category &#x27;Project 1&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-2">Project 2</a><button aria-label="Expand sidebar category &#x27;Project 2&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-3">Project 3</a><button aria-label="Expand sidebar category &#x27;Project 3&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-4">Project 4</a><button aria-label="Expand sidebar category &#x27;Project 4&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-5">Project 5</a><button aria-label="Expand sidebar category &#x27;Project 5&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/redback-documentation/docs/category/cyber-security-team">Cyber Security Team</a><button aria-label="Collapse sidebar category &#x27;Cyber Security Team&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/blue-team">Blue Team</a><button aria-label="Expand sidebar category &#x27;Blue Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/red-team">Red Team</a><button aria-label="Expand sidebar category &#x27;Red Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/redback-documentation/docs/category/secdevops-team">SecDevOps Team</a><button aria-label="Collapse sidebar category &#x27;SecDevOps Team&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/coding-best-practices">Coding Best Practices</a><button aria-label="Expand sidebar category &#x27;Coding Best Practices&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/redback-documentation/docs/category/secure-code-development">Secure Code Development</a><button aria-label="Collapse sidebar category &#x27;Secure Code Development&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/TLSPlan">TLSPlan</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/TLS_Proof_of_Concept_plus_automation">TLS_Proof_of_Concept_plus_automation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/Dependency-Scanner">Dependency-Scanner</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/Dependency-Scanner-Report">Dependency-Scanner-Report</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/Bandit_Documentation">Bandit_Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/adjusting-mac">adjusting-mac</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/project-1-MQTT">project-1-MQTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/flutter-best-practice">flutter-best-practice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/project1-mqtt-secure-code-review">project1-mqtt-secure-code-review</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/secure-code-review-methodologies">secure-code-review-methodologies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/OWASP-Top-10-review">OWASP-Top-10-review</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/azure">Azure</a><button aria-label="Expand sidebar category &#x27;Azure&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/project-management---azure-boards">Project Management - Azure Boards</a><button aria-label="Expand sidebar category &#x27;Project Management - Azure Boards&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/grc-team">GRC Team</a><button aria-label="Expand sidebar category &#x27;GRC Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/infrastrcture-team">Infrastrcture Team</a><button aria-label="Expand sidebar category &#x27;Infrastrcture Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/cyber-security-research">Cyber Security Research</a><button aria-label="Expand sidebar category &#x27;Cyber Security Research&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/redback-documentation/docs/category/cyber-security-guidelines">Archive</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/data-warehousing-team">Data Warehousing Team</a><button aria-label="Expand sidebar category &#x27;Data Warehousing Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/web--mobile-app-dev">Web &amp; Mobile App Dev</a><button aria-label="Expand sidebar category &#x27;Web &amp; Mobile App Dev&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/examples--tutorials">Examples / Tutorials</a><button aria-label="Expand sidebar category &#x27;Examples / Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/documentation-maintenance">Documentation Maintenance</a><button aria-label="Expand sidebar category &#x27;Documentation Maintenance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/redback-documentation/docs/orion-backend/kafkadocs/">orion-backend</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/redback-documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/redback-documentation/docs/category/cyber-security-team"><span itemprop="name">Cyber Security Team</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/redback-documentation/docs/category/secdevops-team"><span itemprop="name">SecDevOps Team</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/redback-documentation/docs/category/secure-code-development"><span itemprop="name">Secure Code Development</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">TLSPlan</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><strong>Last updated by:</strong> T_Apperley, <strong>Last updated on:</strong> &#x27;03/12/2024&#x27;</p>
<p><strong>Last updated by:</strong> T_Apperley, <strong>Last updated on:</strong> &#x27;03/12/2024&#x27;</p>
<header><h1><strong>TLS Solution for MQTT and CoAP Protocols</strong></h1></header>
<h1>Business and Implementation Plan</h1>
<p>By Candice Smith 220484184, 25/07/2024</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>Redback Operations is dedicated to revolutionizing the fitness
experience by developing state-of-the-art connected fitness devices that
not only enhance the enjoyment of physical activity but also its
effectiveness. These devices are designed to transmit information
regarding the identity, behaviours and health of its users, data
outlined by the Redback Operations Security Guidelines as being
sensitive information, protected by the Privacy Act 1988 (&quot;Privacy
Act&quot;). For this reason, ensuring that communication is secure is of
foremost importance. With this report we seek to outline the current
state of security for data in transit from Redback Operations devices
utilising either the MQTT or CoAP protocols. We seek to outline
associated risk and propose an implementation plan for a solution that
will enhance the security posture across all associated devices.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="definitions">Definitions<a href="#definitions" class="hash-link" aria-label="Direct link to Definitions" title="Direct link to Definitions">​</a></h3>
<table><thead><tr><th>Term</th><th>Definition</th></tr></thead><tbody><tr><td>CoAP</td><td>Constrained Application Protocol -- UDP based internet application protocol for constrained devices.</td></tr><tr><td>Data Lakehouse</td><td>Database architecture that combines data lake and data warehouse benefits, by introducing table metadata to files in object storage.</td></tr><tr><td>ECDSA Certificate</td><td>Elliptic Curve Digital Signature Algorithm</td></tr><tr><td>Encryption</td><td>The process of converting plain, readable text to unreadable ciphertext to protect data.</td></tr><tr><td>MQTT</td><td>Message Queuing Telemetry Transport -- common protocol used with IoT devices.</td></tr><tr><td>Security Posture</td><td>An organisation&#x27;s strength and resilience in relation to predicting, preventing, and responding to cyber threats.</td></tr><tr><td>TLS</td><td>Transport Layer Security</td></tr><tr><td>UDP</td><td>User Datagram Protocol</td></tr></tbody></table>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tls-solution">TLS Solution<a href="#tls-solution" class="hash-link" aria-label="Direct link to TLS Solution" title="Direct link to TLS Solution">​</a></h3>
<p>TLS is a cryptographic protocol that works by setting up a secure
connection through a process called the TLS Handshake. This is performed
between a client and server and allows them to communicate in a secure
way that ensures data is protected by encryption from eavesdropping,
manipulation, and other attacks by providing confidentiality,
authenticity, and integrity. During the TLS Handshake a client initiates
a request known as the &#x27;Hello&#x27; message to a server and the server then
responds with it&#x27;s &#x27;Hello&#x27; message. Once this connection is established
an authentication check is done to ensure that the server houses a valid
digital certificate including a private key. If there is no active valid
certificate installed, it has expired, or it has been revoked, the TLS
Handshake will fail, and a connection will not be established. If an
active certificate is present, the client and server complete the TLS
handshake, the server&#x27;s identity is authenticated, and an encrypted
session is established. The client and server can then communicate
securely with all data encrypted by the session keys.</p>
<p><img decoding="async" loading="lazy" src="/redback-documentation/assets/images/TLS_TLShandshake-332d66d214e7e4177b102cd462b783de.png" width="722" height="470" class="img_ev3q"></p>
<p>Mutual TLS, or mTLS as it is known, uses the same technology as TLS but
instead of having a certificate installed only on the server side, it
requires a second certificate to be installed on the client side. The
TLS process operates in the same way as above but allows for the
identity of the server and the client, such as IoT devices to be
authenticated. MTLS offers a much higher level of assurance and risk
mitigation of data breach than regular TLS due to the additional
authentication but is a more complex solution to implement. It should be
considered in future due to the data being transmitted and associated
privacy responsibilities, but this is currently out of scope for the
initial Proof of Concept and Implementation.</p>
<p><img decoding="async" loading="lazy" src="/redback-documentation/assets/images/TLS_mTLShandshake-f4c229b513eabae736f6dbf2639c44be.png" width="724" height="470" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="application-of-tls-solution">Application of TLS Solution<a href="#application-of-tls-solution" class="hash-link" aria-label="Direct link to Application of TLS Solution" title="Direct link to Application of TLS Solution">​</a></h3>
<p>TLS can be applied to a vast array of use cases, including, but not
limited to securing websites, securing IoT communication and
connections, email security, API security, VPN connection, FTP file
transfers, secure software update downloads, cloud services,
authentication via OIDC or similar and secure payments. Given the nature
of the information being captured and communicated throughout the
Redback Operations environment but internal and external, having
encryption and authentication in place to protect that data is a
critical, proactive measure that can be taken to secure that data.</p>
<p>While this implementation focuses on securing MQTT and CoAP
communications there are likely many additional use cases that can be
uncovered for the application of TLS in a very similar way, utilising
the Let&#x27;s Encrypt and Certbot combination. This can be used for the
mobile app that is being developed, for the company website, for any
APIs that are to be utilized, for the database server, as just a start.
This planning document serves as the framework and guidelines for any
future application of TLS in the Redback Organisation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="current-state">Current State<a href="#current-state" class="hash-link" aria-label="Direct link to Current State" title="Direct link to Current State">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h3>
<p>Redback Operations have implemented a messaging protocol allowing their
devices to feed data to a central database where it can be processed to
provide value to users in diverse ways. The currently utilized protocol
is MQTT, which is a lightweight protocol that is scalable and reliable
and a common way to connect IoT devices over the internet. There is a
current review assessing the viability of CoAP as an alternative
protocol allowing an even more lightweight solution improving speed of
processing, though there is not a current implementation for this
protocol. Redback Operations Project 1 has plans to switch to CoAP later
this semester from the current MQTT communications.</p>
<p>Currently MQTT is used throughout the organisation in several ways.
Project 1 is using MQTT to communicate between a Raspberry Pi attached
to their smart bike, their VR game and are working toward communicating
with their mobile app. They are using a HiveMQ broker but have access
issues, and are looking into using data warehousing&#x27;s VM&#x27;s MQTT broker
which relies on Mosquitto. Project 4 -- Orion previously undertook an
assessment of various MQTT Servers, or Brokers, and identified the
recommended services to be provided by HiveMQ. This was followed by an
Implementation Plan and subsequent implementation of HiveMQ as the
broker for Project 1. The focus for this team was deployment of a
functional solution for the transmission of data collected by the
Redback devices, and sent back to a central database, currently Mongo DB
is utilized by some project teams, with a proposal to adopt Dremio as a
Data Lakehouse. Here is an overview of current Project 1 related
architecture:</p>
<p><img decoding="async" loading="lazy" src="/redback-documentation/assets/images/TLS_P1Architecture-00a37ef8516206e6fe0787665ed4955a.png" width="748" height="424" class="img_ev3q"></p>
<p>Overview of broader proposed architecture including additional provision
of services such as web server, API and NTP server:</p>
<p><img decoding="async" loading="lazy" src="/redback-documentation/assets/images/TLS_RedbackArchitecture-6026190a30aa130e7015ebf24341ba40.png" width="738" height="612" class="img_ev3q"></p>
<p>It has been recognized that the data Redback Operations is handling
requires protection as it is sensitive and protected by the Privacy Act.
Redback Operations is responsible for ensuring health, personal and
biometric data collected or transmitted by our devices is protected from
data leakage or breach.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="current-architecture">Current Architecture<a href="#current-architecture" class="hash-link" aria-label="Direct link to Current Architecture" title="Direct link to Current Architecture">​</a></h3>
<p><strong>MQTT Architecture</strong></p>
<p><img decoding="async" loading="lazy" src="/redback-documentation/assets/images/TLS_MQTTArch-0844cc52789aea5a58811d116f435531.png" width="744" height="536" class="img_ev3q"></p>
<p>Central to an MQTT architecture is the MQTT Broker. There are several
MQTT Brokers available for implementation, Redback Operations currently
utilise two solutions, HiveMQ, and Mosquitto. The current HiveMQ broker
is hosted as a serverless cloud service offering usage limited to 100
free connections, 10GB data traffic per month, MQTT versions 3.1, 3.1.1,
5.0, WebSocket support, basic authorization rules and most relevant to
this report is the included MQTT over TLS/SSL offering. Some of risks
associated with this broker are that it includes basic authorization
rules, but does not offer any opportunity to configure the broker as a
developer, and there is an elevated risk with this being a shared MQTT
platform. This may mean it carries a higher risk of unauthorized access
or data breach. The limit of 100 connections presents an issue with
scalability, particularly if this is utilized as a companywide service
connecting with all devices utilising MQTT. HiveMQ identify this service
as being suitable only for basic MQTT learning and experimenting and the
application of this in Redback long term will likely not be suitable.
Finally uptime may be an issue as there are no uptime SLAs for this
solution.</p>
<p>The Moscquitto MQTT Broker is hosted within the on-premise
infrastructure for Redback Operations on a virtual machine that can be
accessed via SSH. This service will offer greater configuration
opportunity, greater control, and greater scalability. If managed well
it may offer greater reliability than the free cloud based HiveMQ broker
and it is possible for this broker to be deployed at scale as it
supports thousands of connections well, not millions though, which
should not be an issue for the scale of the Redback organisation.
Mosquitto offers the ability to integrate with Mongo DB which is
potentially a critical requirement of the Redback Operations
environment.</p>
<p>All other components of the MQTT architecture, called clients, connect
to the MQTT Broker and act as a publisher or subscriber. IoT Devices
that include sensors and other technologies used for gathering data
typically act as publishers, feeding data to the Broker to distribute to
other clients in the network. These other clients subscribe to receive
data from the broker based on categorisation called topics. When
publishers send their data to the Broker it is labelled with a topic,
that information is then distributed only to the devices that subscribe
to the associated topic.</p>
<p><strong>CoAP Architecture (proposed only)</strong></p>
<p><img decoding="async" loading="lazy" src="/redback-documentation/assets/images/TLS_CoAPArch-3315a1097107017000dc654a04defd5c.png" width="1008" height="582" class="img_ev3q"></p>
<p>CoAP is a protocol
that has many similarities to HTTP, which makes it easy to implement for
developers with an existing understanding of HTTP. Like HTTP, CoAP
operates on a request-response communication model where a client sends
a CoAP request to a server and the server responds with the requested
data using GET, PUT, POST and DELETE methods. CoAP is suitable for both
device-to-server communication and machine-to-machine communication, and
it uses UDP which is a connectionless protocol rendering the solution
lighter than MQTT. One compromise with CoAP is that it does not
guarantee reliability by default, but requires a selection from
confirmable, non-confirmable and acknowledgement.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="current-policies">Current Policies<a href="#current-policies" class="hash-link" aria-label="Direct link to Current Policies" title="Direct link to Current Policies">​</a></h3>
<p>There are currently several policies in place that require review to
assess whether the MQTT TLS solution should be included:</p>
<ul>
<li>
<p>Cyber Security Guidelines: Project 1</p>
</li>
<li>
<p>Cyber Security Guidelines: Project 3 -- Wearable Technologies for
Elderly People</p>
</li>
<li>
<p>Cyber Security Guidelines: Project 7 -- Smart Bike Project</p>
</li>
<li>
<p>Cryptography Policy</p>
</li>
<li>
<p>Endpoint Security Policy</p>
</li>
<li>
<p>External Attack Surface Management Policy</p>
</li>
<li>
<p>Server Security Policy</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="risks---mqtt">Risks - MQTT<a href="#risks---mqtt" class="hash-link" aria-label="Direct link to Risks - MQTT" title="Direct link to Risks - MQTT">​</a></h3>
<p>The number of known vulnerabilities with MQTT are growing year on year
with 23 known vulnerabilities in 2020, and 33 being recorded in 2021
with 18 of those being listed as critical vulnerabilities. Many of these
are still not patched today. Some examples are:</p>
<ul>
<li>
<p>Use of insecure default configurations designed to prioritize ease
of use over security.</p>
</li>
<li>
<p>In Eclipse Mosquitto to version 2.0.5, establishing a connection to
the Mosquitto server without sending data triggers a process
resulting in excessive CPU consumption. This could be used by a
malicious actor to perform a denial-of-service type attack.</p>
</li>
<li>
<p>Remote code execution attacks can be caused by buffer overflow
vulnerabilities allowing bad actors to inject and execute malicious
code on IoT devices.</p>
</li>
</ul>
<p>Aside from the above vulnerabilities with MQTT, which can mostly be
mitigated by ensuring the most recent updates and patches are applied,
the key issue with the deployment of MQTT within the Redback
Operations environment is that it is not currently secured using a TLS
solution. This is an optional feature of an MQTT configuration and
without TLS applied all data is transmitted in plain text meaning it
is vulnerable to data leak or data breach.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="risks---coap">Risks - CoAP<a href="#risks---coap" class="hash-link" aria-label="Direct link to Risks - CoAP" title="Direct link to Risks - CoAP">​</a></h3>
<p>There are some good benefits of using CoAP -- it is a lightweight
protocol, often preferred for gathering telemetry data. Like devices
using MQTT, devices using CoAP are often reachable via public facing
IP addresses accessible from the internet. This creates insecure end
points where data can leak, DDoS attacks can be carried out, and
access can be exploited.</p>
<p>Unlike the MQTT protocol, CoAP incorporates DTLS, which is based on
the TLS protocol. The difference being DTLS uses UDP, which is the
transport layer CoAP uses. Like TLS, DTLS will provide encryption, but
also makes sure that the content cannot be altered by third parties
along the network path. DTLS requires a valid EDCSA certificate with a
preference to have been issued by a trusted CA to avoid the issues and
vulnerabilities that go along with self-signed certificates.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="proposed-future-state">Proposed Future State<a href="#proposed-future-state" class="hash-link" aria-label="Direct link to Proposed Future State" title="Direct link to Proposed Future State">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview-1">Overview<a href="#overview-1" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h3>
<p>Both the MQTT and CoAP require a TLS x.509 certificate to ensure the
data being transmitted is encrypted and not delivered in plain text. The
solution proposed will enable TLS for the current MQTT related
architecture and outlines the application of TLS for a suggested
application of CoAP.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="architecture---mqtt">Architecture - MQTT<a href="#architecture---mqtt" class="hash-link" aria-label="Direct link to Architecture - MQTT" title="Direct link to Architecture - MQTT">​</a></h3>
<p><img decoding="async" loading="lazy" src="/redback-documentation/assets/images/TLS_MQTTArchwTLS-086202e23d1a0c3e36c88fc1cc8b1b6c.png" width="836" height="596" class="img_ev3q"></p>
<p>To implement a TLS solution for an MQTT architecture we need to install
a certificate on the MQTT Broker. We have reviewed the use of Let&#x27;s
Encrypt certificates and have identified them as being a feasible
solution in conjunction with Certbot to manage the renewal of those
certificates every 90 days. It is possible to implement mTLS by adding
certificates to the clients as well as the server, but this is optional.
It is also possible to use self-signed certificates to establish this
connection, but that requires the root certificate to be installed on
all clients to establish and maintain trust. Once the certificates are
installed, configuration must occur on both the client and broker side
to facilitate the secured connection TLS offers.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mqtt-server-tls-implementation">MQTT Server TLS Implementation<a href="#mqtt-server-tls-implementation" class="hash-link" aria-label="Direct link to MQTT Server TLS Implementation" title="Direct link to MQTT Server TLS Implementation">​</a></h3>
<p>*Please refer to PoC Retrospective document for validated process</p>
<ol>
<li>
<p>Connect to the Redback Ops server containing the MQTT Broker
(Mosquitto) via SSH.</p>
</li>
<li>
<p>Check Mosquitto is installed and running by entering the following
command:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo systemctl status mosquitto</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Ensure Certbot is not already installed -- the expected return is
nothing:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">which certbot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Install Certbot, commands are dependent on OS:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">sudo apt install certbot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Additional details can be found here: <a href="https://certbot.eff.org/instructions" target="_blank" rel="noopener noreferrer">https://certbot.eff.org/instructions</a></p>
</li>
<li>
<p>Ensure you have a domain associated with your server IP, for this
instructional we&#x27;ll refer to it as mqttserver.domain.com</p>
</li>
<li>
<p>Prove domain control and obtain a certificate:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo certbot certonly \--standalone -d mqttserver.domain.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>You should now be able to locate the certificate files in
/etc/letsencrypt/live/yourdomain.com/.</p>
</li>
<li>
<p>Locate files: fullchain.pem (cert file), and privkey.pem (private
key)</p>
</li>
<li>
<p>Copy Mosquitto config file -- usually found at
&#x27;/etc/mosquitto/mosquitto.conf&#x27; rename copy as
&#x27;/etc/mosquitto/tlsconf.d/&#x27;.</p>
</li>
<li>
<p>Add the following code to enable TLS:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">listener 8883</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">cafile /etc/letsencrypt/live/mqttserver.domain.com/chain.pem</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">certfile /etc/letsencrypt/live/mqttserver.domain.com/fullchain.pem</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">keyfile /etc/letsencrypt/live/mqttserver.domain.com/privkey.pem</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">tls_version tlsv1.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<ul>
<li>
<p>listener 8883 specifies the port for TLS connections (default is
8883 for TLS).</p>
</li>
<li>
<p>cafile points to the CA certificate file (part of the Let&#x27;s Encrypt
chain).</p>
</li>
<li>
<p>certfile points to your server certificate.</p>
</li>
<li>
<p>keyfile points to your private key.</p>
</li>
<li>
<p>tls_version specifies the minimum TLS version to use.</p>
</li>
</ul>
<ol start="11">
<li>
<p>Restart Mosquitto to apply the config changes:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo systemctl restart mosquitto</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Verify config by testing with MQTT Clients</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">mosquitto_sub -h mqttserver.domain.com -p 8883 -t test/topic \--cafile</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">/etc/letsencrypt/live/mqttserver.domain.com/chain.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>*You may need to adjust the port -- please review</strong></p>
</li>
<li>
<p>In the case a client fails to connect, check Mosquitto logs for
errors.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo journalctl -u mosquitto</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Once TLS secured connection is active, automate certificate renewal.</p>
</li>
<li>
<p>Check to see if Certbot has a cron job or systemd timer set up
correctly:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo systemctl list-timers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>*You are looking for &quot;certbot.timer&quot;.</p>
</li>
<li>
<p>Reload Mosquitto config after successful renewal:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo nano /etc/letsencrypt/renewal-hooks/post/reload-mosquitto.sh</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">systemctl reload mosquitto</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">sudo chmod +x /etc/letsencrypt/renewal-hooks/post/reload-mosquitto.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="raspberry-pi-tls-implementation-for-mtls-option">Raspberry Pi TLS Implementation for mTLS option<a href="#raspberry-pi-tls-implementation-for-mtls-option" class="hash-link" aria-label="Direct link to Raspberry Pi TLS Implementation for mTLS option" title="Direct link to Raspberry Pi TLS Implementation for mTLS option">​</a></h3>
<p>For reference if an mTLS solution is required in future. Below process
will need to be tested and validated.</p>
<ol>
<li>
<p>Start by ensuring system is updated:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">sudo apt upgrade</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Install Certbot, this is the command for all OS except Apache:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo apt intall certbot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Ensure you have a valid domain name pointing at your IP, and that
port 80 and port 443 are not blocked. If you are using Cloudflare
DNS services have the DNS set to bypass proxy servers. Ensure port
80 is also forwarded.</p>
</li>
<li>
<p>Let&#x27;s assume we are not running Apache, we now need to grab a Let&#x27;s
Encrypt cert using the built in standalone python server:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo certbot certonly \--standalone -d devicedomain.com -d www.devicedomain.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Enter required detail for Let&#x27;s Encrypt as prompted. Certificate
should then be issued. If you experience issues double check
settings in question 3 and try again.</p>
</li>
<li>
<p>Certificates should now be stored at
/etc/letsencrypt/live/devicedomain.com/</p>
</li>
<li>
<p>Installing the certificate (this is a NGINX guide, you may need to
redefine for other OS), start by opening NGINX config file:</p>
<p>/etc/nginx/ or /etc/nginx/sites-available/</p>
</li>
<li>
<p>Open file in text editor and look for a block as follows:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">server</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">{</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    listen 80 default_server;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    listen \[::\]:80 default_server;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    root /usr/share/nginx/html;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    index index.html index.htm;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    server_name devicedomain.com;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    location / </span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        try_files \$uri \$uri/ =404;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>In this code block, find:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">listen \[::\]:80 default_server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Below this line we will need to add an additional command to
instruct NGINX to listen on port 443, which is the port that handles
HTTPS/SSL traffic and web browser connections:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">listen 443 ssl;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Find:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">server_name example.com;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Below this add:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">ssl_certificate /etc/letsencrypt/live/devicedomain.com/fullchain.pem;</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">ssl_certificate_key /etc/letsencrypt/live/devicedomain.com/privkey.pem;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>NGINX now knows how to locate the certificate files for the TLS
Handshake, and decryption.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="architecture---coap">Architecture - CoAP<a href="#architecture---coap" class="hash-link" aria-label="Direct link to Architecture - CoAP" title="Direct link to Architecture - CoAP">​</a></h3>
<p><img decoding="async" loading="lazy" src="/redback-documentation/assets/images/TLS_CoAPArchwDTLS-f55dec65a048225fd47f0f5d25e19b8e.png" width="1008" height="556" class="img_ev3q"></p>
<p>In the
case of CoAP we need to issue and install ECDSA certificates onto the
CoAP server(s). As we are using DTLS, rather than TLS, we need to
convert the certificate files from .pem to PKCS12 format for them to be
usable in this context. We then configure the CoAP server -- these are
most commonly Eclipe Californium or libcoap based -- and set up the
KeyStore and TrustStore. As in the case of MQTT, if you choose to
implement mutual authentication, certificates can be installed on
clients, but this is not essential.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="coap-implementation">CoAP Implementation<a href="#coap-implementation" class="hash-link" aria-label="Direct link to CoAP Implementation" title="Direct link to CoAP Implementation">​</a></h3>
<ol>
<li>
<p>Set up CoAP server within the on-premises, or cloud environment, and
ensure it has an associated domain that we can prove control of.</p>
</li>
<li>
<p>Install Certbot -- this is dependent on which OS you are utilising,
command line instructions can be found here:
<a href="https://certbot.eff.org/instructions" target="_blank" rel="noopener noreferrer">https://certbot.eff.org/instructions</a> . An example of this is:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo apt-get update</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">sudo apt-get install certbot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Prove domain control (coapserver.domain.com) and obtain an ECDSA
certificate:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo certbot certonly --standalone --preferred-challenges http --key-type ecdsa -d coapserver.domain.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>You should now be able to locate the certificate files in
/etc/letsencrypt/live/coapserver.domain.com/.</p>
</li>
<li>
<p>Locate files: fullchain.pem (cert file), and privkey.pem (private
key)</p>
</li>
<li>
<p>Because we are using DTLS, not TLS we need to convert the .pem files
to PKCS12 format</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">openssl pkcs12 -export -in /etc/letsencrypt/live/coapserver.domain.com/fullchain.pem -inkey /etc/letsencrypt/live/coapserver.domain.com/privkey.pem -out coap-server.p12 -name &quot;coap-server&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>You may need to extract key and certificate from the P12 file:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">openssl pkcs12 -in coap-server.p12 -nocerts -out coap-server.key -nodes</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">openssl pkcs12 -in coap-server.p12 -clcerts -nokeys -out coap-server.crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Next you will need to configure your CoAP server with DTLS -- the
commands will depend on your chosen CoAP implementation. A popular
option is libcoap where you would perform the following commands:</p>
<p>Install libcoap:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">sudo apt install libcoap2 libcoap-dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Configure DTLS on your CoAP server:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">TBC - CoAP server must be identified</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Ensure CoAP server is running and configured with DTLS.</p>
</li>
<li>
<p>Test using CoAP Client library:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token plain">coap-client -m get -u &quot;your-username&quot; -k &quot;your-password&quot; coaps://coapserver.domain.com/resource</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="risk-mitigation-and-best-practice">Risk Mitigation and Best Practice<a href="#risk-mitigation-and-best-practice" class="hash-link" aria-label="Direct link to Risk Mitigation and Best Practice" title="Direct link to Risk Mitigation and Best Practice">​</a></h3>
<p>There are several actions we can take to mitigate risk and apply best
practice. These include:</p>
<p>Enabling encryption of data transmitted using MQTT connections through
Transport Layer Security (TLS) ensures confidentiality and integrity.</p>
<p>Ensure you regularly check for and apply any updates and patches
released by your MQTT software vendor. You may need to update your
broker, clients and libraries to ensure you are addressing
vulnerabilities as they are discovered.</p>
<p>Monitoring and intrusion detection practices are critical in both MQTT
and CoAP environments to identify and respond to suspicious activity on
either network.</p>
<p>In a CoAP based environment ensure both DTLS and ECDSA are utilised. The
combination of the two will provide the best security and the best
performance.</p>
<p>Key rotation is important in both MQTT and CoAP. The shorter the life of
your keys the more secure your environment is, as any vulnerability
relating directly to the key in use is mitigated by rotating to the new
key. It means there is only a limited time attackers have to &#x27;break&#x27;
your cryptographic key and assume control of your data and systems. With
Let&#x27;s Encrypt, certificates have a maximum lifespan of 90 days, and they
are rotated automatically with the use of Certbot.</p>
<p>Key Storage is also very important and in the case of any key and secret
storage, these assets are best held within an HSM, whether it be
hardware or software based.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="feasibility-assessment">Feasibility Assessment<a href="#feasibility-assessment" class="hash-link" aria-label="Direct link to Feasibility Assessment" title="Direct link to Feasibility Assessment">​</a></h3>
<p><strong>Technical Feasibility</strong></p>
<p>Certificate Issuance and Management</p>
<p>By using a combination of Let&#x27;s Encrypt and Certbot certificates can be
successfully issued and installed in both the MQTT and CoAP use cases.
Certbot ensures that certificates are rotated as required to provide
continuity of valid certificates on the server or device we are
protecting.</p>
<p>Certificate Details</p>
<p>The certificates issued by Let&#x27;s Encrypt are in .pem format. This format
is suitable for MQTT but not for CoAP. However, CoAP can utilise a .p12
certificate file which can be derived from converting a .pem file into
this format. CoAP also requires the use of an ECDSA based certificate
which utilises an Eliptic Curve based algorithm for encryption. In this
way we can cover both use cases successfully.</p>
<p>MQTT Broker Configuration</p>
<p>Redback Operations use both Mosquitto and HiveMQ Brokers, and both of
these options do support TLS.</p>
<p><strong>Financial Feasibility</strong></p>
<p>The above solutions are all free of charge, so pose a feasible option
from a financial perspective. The components are Certbot to handle
certificate automation, and Let&#x27;s Encrypt to issue free digital
certificates. These tools are presented with a recommendation to utilize
a Mosquitto MQTT broker which is also free of charge.</p>
<p><strong>Operational Feasibility</strong></p>
<p>The proposed solution is relatively simple to deploy and incorporate
into operational process as a standard across the organization. It can
be incorporated into the management and associated development of
Redback Operations end points and does not add great complexity to
current processes. The benefit of standardizing the use of this TLS
solution for MQTT and CoAP is that it greatly reduces risk of data
compromise and improves the overall security posture of the
organization. This is a lightweight solution that should not jeopardise
performance or scalability of Redback Operations product offering.</p>
<p><strong>Security Feasibility</strong></p>
<p>The addition of TLS for MQTT and DTLS for CoAP will each add great
security benefit as it results in encrypted data hidden from attackers
or eavesdroppers within the Redback environment. It also protects data
from being tampered with. The other benefit for these solutions is
authentication. These security protocols allow a process of
authenticating a server to a client to ensure they are communicating
with the legitimate machine.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="change-management">Change Management<a href="#change-management" class="hash-link" aria-label="Direct link to Change Management" title="Direct link to Change Management">​</a></h3>
<p><strong>Planning</strong>:</p>
<ul>
<li>Define objectives and scope.</li>
<li>Define current state.</li>
<li>Define proposed future state.</li>
<li>Assess current knowledge and skill level for this solution.</li>
<li>Engage current stakeholders including developers of IoT and other
appliance code, owners of end points including authority for current
MQTT infrastructure, Project Team Leaders, Organisation Leaders.</li>
</ul>
<p><strong>Design and Configuration</strong>:</p>
<ul>
<li>Design TLS for MQTT solution, configuration, and security policies.</li>
<li>Design DTLS for CoAP solution, configuration, and security policies.</li>
<li>Record all planning and design content within Business and
Implementation Plan Document.</li>
</ul>
<p><strong>Pilot Implementation</strong>:</p>
<ul>
<li>Set up and configure TLS certificates and MQTT brokers and clients for
single use case.</li>
<li>Set up and configure DTLS certificates and CoAP brokers and clients for
single use case if available.</li>
</ul>
<p><strong>Testing and Validation</strong>:</p>
<ul>
<li>Validate and record step-by-step guide for use as an enablement tool.</li>
<li>Perform functional, security, and performance testing.</li>
<li>Optimize configurations as needed.</li>
</ul>
<p><strong>Org-wide Deployment</strong>:</p>
<ul>
<li>Ensure enablement materials are in place prior to broader deployment.</li>
<li>Map additional use cases and applicable projects.</li>
<li>Plan and execute deployment of solution to wider organisation.</li>
</ul>
<p><strong>Post-Deployment</strong>:</p>
<ul>
<li>Monitor, maintain, and manage certificates.</li>
<li>Update documentation and provide training.</li>
<li>Review and implement improvements.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Redback-Operations/redback-documentation/blob/main/docs/cybersecurity/SecDevOps Team/secure-code/TLSPlan.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/redback-documentation/docs/category/secure-code-development"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Secure Code Development</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/redback-documentation/docs/cybersecurity/SecDevOps Team/secure-code/TLS_Proof_of_Concept_plus_automation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">TLS_Proof_of_Concept_plus_automation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a><ul><li><a href="#definitions" class="table-of-contents__link toc-highlight">Definitions</a></li><li><a href="#tls-solution" class="table-of-contents__link toc-highlight">TLS Solution</a></li><li><a href="#application-of-tls-solution" class="table-of-contents__link toc-highlight">Application of TLS Solution</a></li></ul></li><li><a href="#current-state" class="table-of-contents__link toc-highlight">Current State</a><ul><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#current-architecture" class="table-of-contents__link toc-highlight">Current Architecture</a></li><li><a href="#current-policies" class="table-of-contents__link toc-highlight">Current Policies</a></li><li><a href="#risks---mqtt" class="table-of-contents__link toc-highlight">Risks - MQTT</a></li><li><a href="#risks---coap" class="table-of-contents__link toc-highlight">Risks - CoAP</a></li></ul></li><li><a href="#proposed-future-state" class="table-of-contents__link toc-highlight">Proposed Future State</a><ul><li><a href="#overview-1" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#architecture---mqtt" class="table-of-contents__link toc-highlight">Architecture - MQTT</a></li><li><a href="#mqtt-server-tls-implementation" class="table-of-contents__link toc-highlight">MQTT Server TLS Implementation</a></li><li><a href="#raspberry-pi-tls-implementation-for-mtls-option" class="table-of-contents__link toc-highlight">Raspberry Pi TLS Implementation for mTLS option</a></li><li><a href="#architecture---coap" class="table-of-contents__link toc-highlight">Architecture - CoAP</a></li><li><a href="#coap-implementation" class="table-of-contents__link toc-highlight">CoAP Implementation</a></li><li><a href="#risk-mitigation-and-best-practice" class="table-of-contents__link toc-highlight">Risk Mitigation and Best Practice</a></li><li><a href="#feasibility-assessment" class="table-of-contents__link toc-highlight">Feasibility Assessment</a></li><li><a href="#change-management" class="table-of-contents__link toc-highlight">Change Management</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Info</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/redback-documentation/docs/category/onboarding">Docs</a></li><li class="footer__item"><a href="https://github.com/Redback-Operations" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Redback Operations</div></div></div></footer></div>
</body>
</html>