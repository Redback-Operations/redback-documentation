<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cybersecurity/RED TEAM/usecases/PenTestMQTT" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">PenTestMQTT | Redback Operations</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://github.com/redback-documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://github.com/redback-documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://github.com/redback-documentation/docs/cybersecurity/RED TEAM/usecases/PenTestMQTT"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="PenTestMQTT | Redback Operations"><meta data-rh="true" name="description" content="Last updated by &#x27;23/09/2024&#x27;"><meta data-rh="true" property="og:description" content="Last updated by &#x27;23/09/2024&#x27;"><link data-rh="true" rel="icon" href="/redback-documentation/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://github.com/redback-documentation/docs/cybersecurity/RED TEAM/usecases/PenTestMQTT"><link data-rh="true" rel="alternate" href="https://github.com/redback-documentation/docs/cybersecurity/RED TEAM/usecases/PenTestMQTT" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/redback-documentation/docs/cybersecurity/RED TEAM/usecases/PenTestMQTT" hreflang="x-default"><link rel="stylesheet" href="/redback-documentation/assets/css/styles.24ac416b.css">
<script src="/redback-documentation/assets/js/runtime~main.ad9ebb00.js" defer="defer"></script>
<script src="/redback-documentation/assets/js/main.a5c79969.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/redback-documentation/"><div class="navbar__logo"><img src="/redback-documentation/img/logo.svg" alt="Redback" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/redback-documentation/img/logo.svg" alt="Redback" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Redback</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/redback-documentation/docs/category/onboarding">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Redback-Operations" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/onboarding">Onboarding</a><button aria-label="Expand sidebar category &#x27;Onboarding&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/company-policies">Company Policies</a><button aria-label="Expand sidebar category &#x27;Company Policies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-1">Project 1</a><button aria-label="Expand sidebar category &#x27;Project 1&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-2">Project 2</a><button aria-label="Expand sidebar category &#x27;Project 2&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-3">Project 3</a><button aria-label="Expand sidebar category &#x27;Project 3&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-4">Project 4</a><button aria-label="Expand sidebar category &#x27;Project 4&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/project-5">Project 5</a><button aria-label="Expand sidebar category &#x27;Project 5&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/redback-documentation/docs/category/cyber-security-team">Cyber Security Team</a><button aria-label="Collapse sidebar category &#x27;Cyber Security Team&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/blue-team">Blue Team</a><button aria-label="Expand sidebar category &#x27;Blue Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/redback-documentation/docs/category/red-team">Red Team</a><button aria-label="Collapse sidebar category &#x27;Red Team&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/playbooks">Playbooks</a><button aria-label="Expand sidebar category &#x27;Playbooks&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/redback-documentation/docs/category/usecases">Usecases</a><button aria-label="Collapse sidebar category &#x27;Usecases&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Enumeration">Enumeration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Unauthorised-Access-Red-Team-Usecase">Unauthorised-Access-Red-Team-Usecase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Denial of Service Response">Denial of Service Response</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/elevation of privilage">elevation of privilage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/GapAnalysisM">GapAnalysisM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Improper-Usage-Red-Team-Usecase">Improper-Usage-Red-Team-Usecase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Phishing-Attack-Red-Team-Usecase">Phishing-Attack-Red-Team-Usecase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Root-Access-Red-Team-Usecase">Root-Access-Red-Team-Usecase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Virus Outbreak Incident Response Usecase">Virus Outbreak Incident Response Usecase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Data Theft Incident Response Usecase">Data Theft Incident Response Usecase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/PenTestMQTT">PenTestMQTT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Malware Outbreak Incident Response Usecase">Malware Outbreak Incident Response Usecase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/pentest">pentest</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/SETPhishing">SETPhishing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/phishing">phishing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/PhishingVps">PhishingVps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/GapAnalysis_RedTeamRedback">GapAnalysis_RedTeamRedback</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/gap_analysis">gap_analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/pdf">pdf</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/backend--penetration-testing">Backend &amp; Penetration Testing</a><button aria-label="Expand sidebar category &#x27;Backend &amp; Penetration Testing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/secdevops-team">SecDevOps Team</a><button aria-label="Expand sidebar category &#x27;SecDevOps Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/grc-team">GRC Team</a><button aria-label="Expand sidebar category &#x27;GRC Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/infrastrcture-team">Infrastrcture Team</a><button aria-label="Expand sidebar category &#x27;Infrastrcture Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/redback-documentation/docs/category/cyber-security-research">Cyber Security Research</a><button aria-label="Expand sidebar category &#x27;Cyber Security Research&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/redback-documentation/docs/category/cyber-security-guidelines">Archive</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/data-warehousing-team">Data Warehousing Team</a><button aria-label="Expand sidebar category &#x27;Data Warehousing Team&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/web--mobile-app-dev">Web &amp; Mobile App Dev</a><button aria-label="Expand sidebar category &#x27;Web &amp; Mobile App Dev&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/examples--tutorials">Examples / Tutorials</a><button aria-label="Expand sidebar category &#x27;Examples / Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/redback-documentation/docs/category/documentation-maintenance">Documentation Maintenance</a><button aria-label="Expand sidebar category &#x27;Documentation Maintenance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/redback-documentation/docs/orion-backend/kafkadocs/">orion-backend</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/redback-documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/redback-documentation/docs/category/cyber-security-team"><span itemprop="name">Cyber Security Team</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/redback-documentation/docs/category/red-team"><span itemprop="name">Red Team</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/redback-documentation/docs/category/usecases"><span itemprop="name">Usecases</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">PenTestMQTT</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><strong>Last updated by:</strong> Manasa, <strong>Last updated on:</strong> &#x27;23/09/2024&#x27;</p>
<p><strong>Last updated by:</strong> Manasa, <strong>Last updated on:</strong> &#x27;23/09/2024&#x27;</p>
<header><h1>Penetration Test of MQTT Server</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>The key concepts of penetration testing and MQTT (Message Queuing Telemetry Transport) are essential in the realms of cybersecurity and real-time messaging. Penetration testing plays an important role in identifying system vulnerabilities and enhancing defenses against potential threats. On the other hand, MQTT is widely used in IoT and messaging applications to facilitate communication between clients. Tools such as Nmap, which is used for network scanning, and Wireshark, for packet analysis, are vital in assessing and ensuring the security and efficiency of these operations.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="penetration-test-on-redbackitdeakineduau-mqtt-server">Penetration Test on redback.it.deakin.edu.au MQTT Server:<a href="#penetration-test-on-redbackitdeakineduau-mqtt-server" class="hash-link" aria-label="Direct link to Penetration Test on redback.it.deakin.edu.au MQTT Server:" title="Direct link to Penetration Test on redback.it.deakin.edu.au MQTT Server:">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nmap-to-scan-redbackitdeakineduau-ip-address-101370149">Nmap to Scan redback.it.deakin.edu.au (ip address 10.137.0149)<a href="#nmap-to-scan-redbackitdeakineduau-ip-address-101370149" class="hash-link" aria-label="Direct link to Nmap to Scan redback.it.deakin.edu.au (ip address 10.137.0149)" title="Direct link to Nmap to Scan redback.it.deakin.edu.au (ip address 10.137.0149)">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Checking whether the host is up or not" src="/redback-documentation/assets/images/Host-Scan-78c8a36c9c89adb5d043409cfed62231.png" width="998" height="1348" class="img_ev3q"></p>
<ul>
<li>nmap to check whether the host (redback.it.deakin.edu.au with IP 10.137.0.149) is online and responding to network requests. The output indicates that the host is up with a latency of 0.032 seconds.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ping-101370149">ping 10.137.0.149<a href="#ping-101370149" class="hash-link" aria-label="Direct link to ping 10.137.0.149" title="Direct link to ping 10.137.0.149">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="purpose">Purpose:<a href="#purpose" class="hash-link" aria-label="Direct link to Purpose:" title="Direct link to Purpose:">​</a></h4>
<ul>
<li><strong>Check Host Availability:</strong> The ping command was used to verify whether the host at IP address 10.137.0.149 is reachable and responsive over the network. By sending ICMP (Internet Control Message Protocol) Echo Request packets, the command measures the time it takes for the host to respond, confirming its availability.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Host Availability" src="/redback-documentation/assets/images/Host-Ping-909f087afc81bcfad6dd8676a8b9049c.png" width="882" height="400" class="img_ev3q"></p>
<ul>
<li>The ping test confirms that the host at 10.137.0.149 is up and responding with minimal latency and no packet loss, making it reachable for further communication or scanning tasks.</li>
</ul>
<p><strong>Opening the website:</strong> We can see a file upload page on the site.</p>
<p><img decoding="async" loading="lazy" alt="Website" src="/redback-documentation/assets/images/Website-f3f705d872bffa4feb072a551702cdbe.png" width="1538" height="822" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-port-scan-of-101370149">Full Port Scan of 10.137.0.149<a href="#full-port-scan-of-101370149" class="hash-link" aria-label="Direct link to Full Port Scan of 10.137.0.149" title="Direct link to Full Port Scan of 10.137.0.149">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Scanning all the ports" src="/redback-documentation/assets/images/FullPort-Scan-b4535704239c63344323d88b21c5efde.png" width="1120" height="1026" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="purpose-1">Purpose:<a href="#purpose-1" class="hash-link" aria-label="Direct link to Purpose:" title="Direct link to Purpose:">​</a></h4>
<ul>
<li><strong>Comprehensive Port Scan:</strong> The -p- flag tells Nmap to scan all 65,535 TCP ports on the target host (10.137.0.149). This command ensures that no port is missed, providing a full overview of which ports are open, closed, or filtered.</li>
<li><strong>SYN Stealth Scan:</strong> Nmap uses a SYN Stealth Scan by default when running with sudo privileges. This scan sends SYN packets and waits for responses to identify open ports, without completing the TCP connection. This is a faster and stealthier method of scanning compared to a full TCP connection scan.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-details-from-the-output">Key Details from the Output:<a href="#key-details-from-the-output" class="hash-link" aria-label="Direct link to Key Details from the Output:" title="Direct link to Key Details from the Output:">​</a></h4>
<ul>
<li>
<p><strong>Host Status:</strong> The host 10.137.0.149 is up with a very low latency of 0.00091s, indicating a fast response from the host.</p>
</li>
<li>
<p><strong>Filtered and Closed Ports:</strong></p>
<ul>
<li>65,020 filtered ports: These ports did not respond to the scan, likely due to firewall rules or packet filtering.</li>
<li>492 closed ports: These ports responded with a TCP reset, meaning no service is running on these ports.</li>
</ul>
</li>
<li>
<p><strong>Open Ports and Services:</strong> The scan found several open ports with services running on them, including:</p>
<ul>
<li>22/tcp: SSH (Secure Shell)</li>
<li>25/tcp: SMTP (Simple Mail Transfer Protocol)</li>
<li>80/tcp: HTTP (HyperText Transfer Protocol)</li>
<li>443/tcp: HTTPS (HTTP Secure)</li>
<li>1514/tcp: Fujitsu DTCNS</li>
<li>1883/tcp: MQTT (Message Queuing Telemetry Transport)</li>
<li>5000/tcp: UPnP (Universal Plug and Play)</li>
<li>5001/tcp: Commplex-link</li>
<li>8000/tcp: HTTP-alt (Alternative HTTP Port)</li>
<li>8080/tcp: HTTP Proxy</li>
<li>8888/tcp: Sun Answerbook</li>
<li>9000/tcp: CSListener</li>
<li>9001/tcp: Tor ORPort (used for Tor network)</li>
<li>27017/tcp: MongoDB (default port for MongoDB database)</li>
<li>50000/tcp: IBM DB2 database</li>
<li>Several other open ports with unknown services, such as 9047, 19120, 31010, 32010, and 55000.</li>
</ul>
</li>
<li>
<p><strong>Port 8883/tcp:</strong> The port is filtered, meaning that network devices (such as firewalls) are blocking direct communication on this port. This suggests that secure MQTT (MQTT over TLS/SSL) is not currently accessible.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="operating-system-of-the-host">Operating System of the Host<a href="#operating-system-of-the-host" class="hash-link" aria-label="Direct link to Operating System of the Host" title="Direct link to Operating System of the Host">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Host OS" src="/redback-documentation/assets/images/Operating-System-1d848c8adefd4c4a02af803e7e391965.png" width="1372" height="920" class="img_ev3q"></p>
<ul>
<li>Based on the Nmap scan results, it appears that the host (IP address 10.137.0.149) is most likely running in a virtualized environment. The OS guess provided by Nmap suggests that it is either running Oracle VirtualBox (95%)or QEMU (91%) as the virtualization software. However, the exact operating system could not be identified due to insufficient open and closed port data.This means the system could be running on a guest operating system inside one of these virtual environments.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nmap-command-to-scan-mqtt-ports-1883-8883-on-101370149">Nmap Command to Scan MQTT Ports (1883, 8883) on 10.137.0.149<a href="#nmap-command-to-scan-mqtt-ports-1883-8883-on-101370149" class="hash-link" aria-label="Direct link to Nmap Command to Scan MQTT Ports (1883, 8883) on 10.137.0.149" title="Direct link to Nmap Command to Scan MQTT Ports (1883, 8883) on 10.137.0.149">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Scanning the MQTT Ports" src="/redback-documentation/assets/images/MQTTPorts-2bf89b4f31a300115b2ecba08cf6e139.png" width="946" height="390" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-details-from-the-output-1">Key Details from the Output:<a href="#key-details-from-the-output-1" class="hash-link" aria-label="Direct link to Key Details from the Output:" title="Direct link to Key Details from the Output:">​</a></h4>
<ul>
<li>-p specifies which port or ports to scan. In this case, you are telling Nmap to scan ports 1883 and 8883 only, which are the default ports for the MQTT protocol.</li>
<li>Host Status: The host 10.137.0.149 is up, with a latency of 0.015 seconds, indicating a quick response from the host.</li>
<li>Port 1883/tcp: This port is open, indicating that the MQTT service is accessible on this port for unencrypted communication.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="service-version-detection-scan-on-port-1883">Service Version Detection Scan on Port 1883<a href="#service-version-detection-scan-on-port-1883" class="hash-link" aria-label="Direct link to Service Version Detection Scan on Port 1883" title="Direct link to Service Version Detection Scan on Port 1883">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Detecting the Service Version" src="/redback-documentation/assets/images/Version-bad72c8170193e2e114f77a75ccf3fd8.png" width="1330" height="750" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation">Explanation:<a href="#explanation" class="hash-link" aria-label="Direct link to Explanation:" title="Direct link to Explanation:">​</a></h4>
<ul>
<li><strong>Service Version Detection (-sV):</strong> The -sV option in Nmap tells it to not only check if the port is open but also to attempt to detect the version of the service running on the specified port.</li>
<li><strong>Port-Specific Scan (-p 1883):</strong> The scan is focused specifically on port 1883, which is the default port for MQTT services.</li>
<li><strong>Port 1883 is open:</strong> Port 1883 is open, meaning the MQTT service is accessible on this</li>
<li><strong>Service:</strong> Nmap detected that the service running on port 1883 is Mosquitto, which is a popular MQTT broker.</li>
<li><strong>Version:</strong> The version of the Mosquitto broker is 1.6.9, providing detailed information about the service.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nmap-vulnerability-scan-on-port-1883-101370149">Nmap Vulnerability Scan on port 1883 10.137.0.149<a href="#nmap-vulnerability-scan-on-port-1883-101370149" class="hash-link" aria-label="Direct link to Nmap Vulnerability Scan on port 1883 10.137.0.149" title="Direct link to Nmap Vulnerability Scan on port 1883 10.137.0.149">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Vulnerability Scanning of the MQTT Port" src="/redback-documentation/assets/images/VulnScanMQTT1-c7a14385c27104bcec1fa6cb19c25e46.png" width="1074" height="1282" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Vulnerability Scanning of the MQTT Port" src="/redback-documentation/assets/images/VulnScanMQTT2-4c279177d4f21093e19db3e7e6028be3.png" width="1292" height="868" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Vulnerability Scanning of the MQTT Port" src="/redback-documentation/assets/images/VulnScanMQTT3-36d242e0a31758f834d50d5323cbc221.png" width="980" height="816" class="img_ev3q"></p>
<ul>
<li><strong>Vulnerability Scan (--script vuln):</strong> The --script vuln option in Nmap tells it to run a set of scripts that detect common vulnerabilities on the target host. This includes potential issues with various services running on the host.</li>
<li><strong>port 1883</strong> (MQTT) was scanned, no vulnerabilities were detected specifically for the MQTT service running on that port. The scan focused on detecting commonly known vulnerabilities across all the open ports but did not flag any issues with the MQTT service on port 1883.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aggressive-scanning-on-port-1883-script-detection">Aggressive Scanning on Port 1883 Script Detection<a href="#aggressive-scanning-on-port-1883-script-detection" class="hash-link" aria-label="Direct link to Aggressive Scanning on Port 1883 Script Detection" title="Direct link to Aggressive Scanning on Port 1883 Script Detection">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Aggressive Scan of 1883 MQTT Port" src="/redback-documentation/assets/images/AggressiveScanMQTT-63b039596da08af47f93139716d46049.png" width="1096" height="798" class="img_ev3q"></p>
<ul>
<li><strong>Advanced Scan (-A):</strong> The -A option in Nmap enables aggressive scanning, which includes OS Detection, Service Version Detection, Script Scanning and Traceroute.</li>
<li><strong>Host Status:</strong> The host 10.137.0.149 is up, with low latency of 0.010 seconds.</li>
<li><strong>Port 1883 (MQTT) Service:</strong> The service running on port 1883 is identified as Mosquitto MQTT broker, version 1.6.9.</li>
<li><strong>Script Output - mqtt-subscribe:</strong> The script gathered real-time information from the broker’s system topics ($SYS/ topics) that provide internal metrics of the broker.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mosquitto-and-mosquitto-clients-installation">Mosquitto and Mosquitto Clients Installation<a href="#mosquitto-and-mosquitto-clients-installation" class="hash-link" aria-label="Direct link to Mosquitto and Mosquitto Clients Installation" title="Direct link to Mosquitto and Mosquitto Clients Installation">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Installing Mosquitto" src="/redback-documentation/assets/images/Mosquitto-Install-f849eeb53ba356dfdb8f89cd131471a1.png" width="1288" height="622" class="img_ev3q"></p>
<ul>
<li>The mosquitto -h command provides an overview of the available options for starting and configuring the Mosquitto MQTT broker. We can use these options to customize the broker&#x27;s behavior, such as setting a config file, changing the port, or running it in the background.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Verifying the Installlation" src="/redback-documentation/assets/images/Verify-Install-a80f800af5f3511e88fa6422af26231a.png" width="736" height="482" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="output-with-mqtt-subscribe-script">Output with mqtt-subscribe Script<a href="#output-with-mqtt-subscribe-script" class="hash-link" aria-label="Direct link to Output with mqtt-subscribe Script" title="Direct link to Output with mqtt-subscribe Script">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Subscribing to MQTT Scripts" src="/redback-documentation/assets/images/Subscribe-Scripts-baff2bfec97f07a8f7a159e40058968f.png" width="782" height="1274" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="purpose-2">Purpose:<a href="#purpose-2" class="hash-link" aria-label="Direct link to Purpose:" title="Direct link to Purpose:">​</a></h4>
<p>This command scanned the MQTT broker running on port 1883 of the target host 10.137.0.149 and used the mqtt-subscribe script to gather real-time system information by subscribing to MQTT topics, including the $SYS topics, which provide internal broker metrics.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-details-from-the-output-2">Key Details from the Output:<a href="#key-details-from-the-output-2" class="hash-link" aria-label="Direct link to Key Details from the Output:" title="Direct link to Key Details from the Output:">​</a></h4>
<p><strong>Host and Service Information:</strong></p>
<ul>
<li>Host: redback.it.deakin.edu.au is up, with a very low latency of 0.011 seconds.</li>
<li>Service on Port 1883: The service running on port 1883 is Mosquitto, version 1.6.9.</li>
</ul>
<p><strong>MQTT Topics and Metrics:</strong> The script successfully subscribed to various $SYS topics and retrieved detailed metrics about the broker’s status:</p>
<ul>
<li><strong>Broker Version:</strong>
<ul>
<li>$SYS/broker/version: The broker is running Mosquitto version 1.6.9.</li>
</ul>
</li>
<li><strong>Broker Uptime:</strong>
<ul>
<li>$SYS/broker/uptime: The broker has been running for 1,053,514 seconds (~12 days).</li>
</ul>
</li>
<li><strong>Clients:</strong>
<ul>
<li>$SYS/broker/clients/connected: Currently, 1 client is connected.</li>
<li>$SYS/broker/clients/active: 1 active client.</li>
<li>$SYS/broker/clients/total: A total of 34 clients have connected.</li>
<li>$SYS/broker/clients/maximum: The maximum number of clients connected at any time was 34.</li>
</ul>
</li>
<li><strong>Message Traffic:8</strong>
<ul>
<li>$SYS/broker/messages/received: The broker has received 10,210 messages.</li>
<li>$SYS/broker/messages/sent: The broker has sent 9,913 messages.</li>
<li>$SYS/broker/publish/messages/sent: 2,682 messages have been published.</li>
<li>$SYS/broker/messages/stored: There are 27 stored messages.</li>
</ul>
</li>
<li><strong>Load Metrics:</strong>
<ul>
<li>$SYS/broker/load/messages/sent/1min: The broker sent an average of 3.65 messages per minute over the last minute.</li>
<li>$SYS/broker/load/bytes/sent/5min: 18.26 bytes were sent over the last 5 minutes.</li>
<li>$SYS/broker/load/messages/received/1min: The broker received 1.83 messages per minute over the last minute.</li>
</ul>
</li>
<li><strong>Other Key Metrics:</strong>
<ul>
<li>Subscriptions: $SYS/broker/subscriptions/count: There are 52 active subscriptions.</li>
<li>Heap Memory Usage: $SYS/broker/heap/current: The current heap memory usage is 76,160 bytes.</li>
<li>Data Transfer:<!-- -->
<ul>
<li>$SYS/broker/bytes/sent: 134,006 bytes have been sent by the broker.</li>
<li>$SYS/broker/bytes/received: 258,880 bytes have been received.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="wireshark-network-capture">Wireshark Network Capture:<a href="#wireshark-network-capture" class="hash-link" aria-label="Direct link to Wireshark Network Capture:" title="Direct link to Wireshark Network Capture:">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Wireshark Capture when Subscribed to all the Scripts" src="/redback-documentation/assets/images/Wireshark-Sub-Scripts1-237bc27be7a8ddbb9320803c712f6c4e.png" width="1310" height="1306" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Wireshark Capture when Subscribed to all the Scripts" src="/redback-documentation/assets/images/Wireshark-Sub-Scripts2-c6c8422ffc258421b7b6a4f1abb91cf4.png" width="1306" height="1300" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="information-from-the-captured-packets">Information from the Captured Packets:<a href="#information-from-the-captured-packets" class="hash-link" aria-label="Direct link to Information from the Captured Packets:" title="Direct link to Information from the Captured Packets:">​</a></h4>
<ul>
<li>
<p>SYN (Synchronize Packet): Initial connection request from the client to the server (10.137.0.149), indicating the start of a TCP three-way handshake.</p>
</li>
<li>
<p>SYN-ACK (Synchronize-Acknowledge): The server responds to the client&#x27;s SYN with a SYN-ACK, indicating that it is willing to establish the connection and synchronizing the sequence numbers.</p>
</li>
<li>
<p>TCP ACK: The client acknowledges the server&#x27;s SYN-ACK, completing the TCP three-way handshake. This opens the connection for data transmission.</p>
</li>
<li>
<p>MQTT Connect: After the TCP connection is established, the client sends an MQTT Connect request to initiate communication with the MQTT broker. This is the start of the MQTT session.</p>
</li>
<li>
<p>MQTT Connect ACK: The MQTT broker acknowledges the connection request by sending a Connect ACK, confirming that the client is successfully connected to the broker and can start subscribing or publishing to topics.</p>
</li>
<li>
<p>MQTT Subscribe and Acknowledgement:</p>
<ul>
<li>The client sends a subscription request to the MQTT broker (likely to topics like $SYS).</li>
<li>The broker acknowledges the subscription with an MQTT Subscribe ACK message.</li>
</ul>
</li>
<li>
<p>MQTT Publish:</p>
<ul>
<li>The broker publishes messages on topics such as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>Y</mi><mi>S</mi><mi mathvariant="normal">/</mi><mi>b</mi><mi>r</mi><mi>o</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi mathvariant="normal">/</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">SYS/broker/version, </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord">/</span><span class="mord mathnormal">b</span><span class="mord mathnormal">ro</span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mord mathnormal" style="margin-right:0.02778em">er</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mord mathnormal">ers</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mpunct">,</span></span></span></span>SYS/broker/uptime, $SYS/broker/load/messages/sent, etc.</li>
<li>The client receives these messages, which include operational statistics and other data related to the broker’s current status.</li>
</ul>
</li>
<li>
<p>Key Information in Messages:</p>
<ul>
<li>The published messages include important information such as the broker version (mosquitto version 1.6.9), number of active and connected clients, uptime, and load information.</li>
<li>Topics like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>Y</mi><mi>S</mi><mi mathvariant="normal">/</mi><mi>b</mi><mi>r</mi><mi>o</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi mathvariant="normal">/</mi><mi>l</mi><mi>o</mi><mi>a</mi><mi>d</mi><mi mathvariant="normal">/</mi><mi>b</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi mathvariant="normal">/</mi><mi>s</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi mathvariant="normal">/</mi><mn>5</mn><mi>m</mi><mi>i</mi><mi>n</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">SYS/broker/load/bytes/sent/5min, </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord mathnormal" style="margin-right:0.22222em">Y</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord">/</span><span class="mord mathnormal">b</span><span class="mord mathnormal">ro</span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mord mathnormal" style="margin-right:0.02778em">er</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord">/</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mord mathnormal">t</span><span class="mord mathnormal">es</span><span class="mord">/</span><span class="mord mathnormal">se</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord">/5</span><span class="mord mathnormal">min</span><span class="mpunct">,</span></span></span></span>SYS/broker/clients/connected provide detailed statistics on broker performance.</li>
</ul>
</li>
<li>
<p>QoS (Quality of Service): The messages use QoS level 0 (At most once delivery), meaning messages are delivered on a best-effort basis, with no acknowledgment from the recipient required.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="subscribing-to-all-topics-listening-port">Subscribing to all topics Listening port<a href="#subscribing-to-all-topics-listening-port" class="hash-link" aria-label="Direct link to Subscribing to all topics Listening port" title="Direct link to Subscribing to all topics Listening port">​</a></h3>
<p><img decoding="async" loading="lazy" alt="MQTT Listening on Port 1883 to print all published messages" src="/redback-documentation/assets/images/ListeningPort-1b7dc6da1f3e4b025e43ae0bd41c9f25.png" width="640" height="62" class="img_ev3q"></p>
<p>The broker at 10.137.0.149 is actively listening on port 1883 as indicated by the Nmap scan results. This means it is ready to accept MQTT connections, print out all messages that are published to any topic, along with their topic names.</p>
<ul>
<li><strong>Breakdown:</strong>
<ul>
<li>mosquitto_sub: This is the command-line tool to subscribe to MQTT topics. It allows you to receive messages published to specific topics on an MQTT broker.</li>
<li>-h 10.137.0.149: Specifies the host of the MQTT broker you are connecting to, which is at IP address 10.137.0.149.</li>
<li>-p 1883: Specifies the port on which the broker is listening for MQTT traffic. 1883 is the default port for unencrypted MQTT communication.</li>
<li>-t &#x27;#&#x27;: Subscribes to all topics. The # wildcard subscribes to every topic on the broker, including system topics ($SYS/) and any custom topics being published.</li>
<li>-v: Enables verbose mode, meaning that both the topic name and the message payload will be displayed when a message is received.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="publishing-non-persistent-messages-in-mqtt">Publishing Non-Persistent Messages in MQTT<a href="#publishing-non-persistent-messages-in-mqtt" class="hash-link" aria-label="Direct link to Publishing Non-Persistent Messages in MQTT" title="Direct link to Publishing Non-Persistent Messages in MQTT">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Publishing Non-Persistent Messages" src="/redback-documentation/assets/images/Publish-NPMessages-ce22ac312d406407eb458a8d77b6c2f4.png" width="878" height="128" class="img_ev3q"></p>
<ul>
<li>Publishing the message &quot;Hello MQTT&quot; to the topic &quot;test/topic&quot;.</li>
<li>Publishing the message &quot;Test Message&quot; to the same topic &quot;test/topic&quot;.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Printing Non-Persistent Messages" src="/redback-documentation/assets/images/Response-ee9b58b0811855e8bf310f0c38e31f74.png" width="612" height="126" class="img_ev3q"></p>
<ul>
<li>Subscribes to all topics (# wildcard) on the MQTT broker with verbose mode (-v), which shows both the topic and message payloads when receiving messages.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="wireshark-network-capture-1">Wireshark Network Capture:<a href="#wireshark-network-capture-1" class="hash-link" aria-label="Direct link to Wireshark Network Capture:" title="Direct link to Wireshark Network Capture:">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Capturing Wireshark Network for Non Persistent Published Messages" src="/redback-documentation/assets/images/Wireshark-NPResponse-424a32709afdc2af0c322e813e02d24b.png" width="1298" height="1312" class="img_ev3q"></p>
<ul>
<li><strong>Analysis:</strong>
<ul>
<li>The client sends the MQTT Connect request after establishing a TCP connection with the broker.</li>
<li>ACK (Acknowledgment) packets are exchanged after each publish to confirm the delivery of messages between the client and broker.</li>
<li>In the MQTT Publish packets, the message contents such as &quot;Hello MQTT&quot; and &quot;Test Message&quot; are visible in the data field.</li>
<li>The broker accepts and relays the messages to the subscribed clients (as seen in the subscription capture), but since QoS 0 (At most once delivery, fire-and-forget) is used, the messages are not stored by the broker.</li>
</ul>
</li>
<li><strong>Message Transmission:</strong>
<ul>
<li>The messages &quot;Hello MQTT&quot; and &quot;Test Message&quot; are published to the broker and immediately received by the subscribed client.</li>
<li>The capture confirms the messages are transmitted in real time, but because QoS 0 is used, the messages are not retained or stored by the broker for future subscribers.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="real-time-message-transmission-in-mqtt-with-retention">Real-Time Message Transmission in MQTT with Retention<a href="#real-time-message-transmission-in-mqtt-with-retention" class="hash-link" aria-label="Direct link to Real-Time Message Transmission in MQTT with Retention" title="Direct link to Real-Time Message Transmission in MQTT with Retention">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Publishing Persistent Messages" src="/redback-documentation/assets/images/Publish-PMessages-b54a7466f429853de5921ddd0ce7fa5b.png" width="1028" height="136" class="img_ev3q"></p>
<ul>
<li>Publishing the message &quot;Good Morning MQTT&quot; to the topic &quot;test/topic&quot; with the -r flag, meaning it is a retained message.</li>
<li>Publishing the message &quot;Nice to meet you MQTT&quot; to the same topic, also as a retained message.</li>
<li>If a message is published with the retained flag set, the broker will store the message even if no subscribers are currently connected. The broker will deliver the retained message to any new subscribers when they connect.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Printing Persistent Messages" src="/redback-documentation/assets/images/ResponseP1-116dcf9fcdee95cd19ee5985e98374de.png" width="844" height="934" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Printing Persistent Messages and showing in the subscribed topics" src="/redback-documentation/assets/images/ResponseP2-c10beb38520f766ca79edcc93c3815d2.png" width="696" height="1124" class="img_ev3q"></p>
<ul>
<li>When subscribing to the topic, the retained messages &quot;Good Morning MQTT&quot; and &quot;Nice to meet you MQTT&quot; are immediately delivered to the subscriber because they were stored on the broker as retained messages.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="wireshark-network-capture-2">Wireshark Network Capture:<a href="#wireshark-network-capture-2" class="hash-link" aria-label="Direct link to Wireshark Network Capture:" title="Direct link to Wireshark Network Capture:">​</a></h4>
<p><img decoding="async" loading="lazy" alt="Wireshark Network to the Retained Messages" src="/redback-documentation/assets/images/Wireshark-PResponse-de80f68cfbe48fc21a7e9339adbcebc9.png" width="1146" height="1156" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-points">Key Points:<a href="#key-points" class="hash-link" aria-label="Direct link to Key Points:" title="Direct link to Key Points:">​</a></h4>
<ul>
<li><strong>Retained Messages:</strong> The MQTT messages are marked as retained, meaning that they will remain on the broker until they are overwritten or cleared. Any new subscriber to the test/topic will immediately receive the last retained message.</li>
<li><strong>Real-Time Transmission:</strong> The retained messages are also transmitted in real time to any current subscribers when published.</li>
<li><strong>TCP &amp; MQTT Acknowledgments:</strong> The client receives TCP acknowledgments and MQTT ACKs after each message is published, confirming successful transmission.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="findings">Findings:<a href="#findings" class="hash-link" aria-label="Direct link to Findings:" title="Direct link to Findings:">​</a></h3>
<ul>
<li>The mqtt-subscribe script provided valuable insights into the internal workings and metrics of the MQTT broker, including traffic, client activity, memory usage, and uptime.</li>
<li><strong>Vulnerability Found:</strong> The broker at 10.137.0.149 allows anyone to subscribe and publish messages without authentication, it indicates that this broker is misconfigured to allow unauthenticated connections.</li>
<li>This would be considered a security risk, as unauthorized users can subscribe to topics, potentially eavesdrop on messages, and perform malicious activities such as publishing unwanted data to the broker.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="suggestions">Suggestions:<a href="#suggestions" class="hash-link" aria-label="Direct link to Suggestions:" title="Direct link to Suggestions:">​</a></h3>
<ul>
<li>To mitigate this risk, the MQTT broker should implement:<!-- -->
<ul>
<li><strong>Username/Password Authentication:</strong> Require clients to authenticate before subscribing or publishing.</li>
<li><strong>TLS/SSL:</strong> Encrypt communication between clients and the broker to prevent eavesdropping.</li>
<li><strong>Access Control Lists (ACLs):</strong> Control which users or clients are allowed to publish or subscribe to specific topics.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion:<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion:" title="Direct link to Conclusion:">​</a></h3>
<p>In conclusion, penetration testing is a critical cybersecurity practice for identifying and addressing vulnerabilities in systems, networks, and applications before they can be exploited. Understanding the security of an MQTT broker is essential, as it can be a target for attacks, making strong security practices like penetration testing important to maintain secure operations.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Redback-Operations/redback-documentation/blob/main/docs/cybersecurity/RED TEAM/usecases/PenTestMQTT.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Data Theft Incident Response Usecase"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Data Theft Incident Response Usecase</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/redback-documentation/docs/cybersecurity/RED TEAM/usecases/Malware Outbreak Incident Response Usecase"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Malware Outbreak Incident Response Usecase</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#penetration-test-on-redbackitdeakineduau-mqtt-server" class="table-of-contents__link toc-highlight">Penetration Test on redback.it.deakin.edu.au MQTT Server:</a><ul><li><a href="#nmap-to-scan-redbackitdeakineduau-ip-address-101370149" class="table-of-contents__link toc-highlight">Nmap to Scan redback.it.deakin.edu.au (ip address 10.137.0149)</a></li><li><a href="#ping-101370149" class="table-of-contents__link toc-highlight">ping 10.137.0.149</a><ul><li><a href="#purpose" class="table-of-contents__link toc-highlight">Purpose:</a></li></ul></li><li><a href="#full-port-scan-of-101370149" class="table-of-contents__link toc-highlight">Full Port Scan of 10.137.0.149</a><ul><li><a href="#purpose-1" class="table-of-contents__link toc-highlight">Purpose:</a></li><li><a href="#key-details-from-the-output" class="table-of-contents__link toc-highlight">Key Details from the Output:</a></li></ul></li><li><a href="#operating-system-of-the-host" class="table-of-contents__link toc-highlight">Operating System of the Host</a></li><li><a href="#nmap-command-to-scan-mqtt-ports-1883-8883-on-101370149" class="table-of-contents__link toc-highlight">Nmap Command to Scan MQTT Ports (1883, 8883) on 10.137.0.149</a><ul><li><a href="#key-details-from-the-output-1" class="table-of-contents__link toc-highlight">Key Details from the Output:</a></li></ul></li><li><a href="#service-version-detection-scan-on-port-1883" class="table-of-contents__link toc-highlight">Service Version Detection Scan on Port 1883</a><ul><li><a href="#explanation" class="table-of-contents__link toc-highlight">Explanation:</a></li></ul></li><li><a href="#nmap-vulnerability-scan-on-port-1883-101370149" class="table-of-contents__link toc-highlight">Nmap Vulnerability Scan on port 1883 10.137.0.149</a></li><li><a href="#aggressive-scanning-on-port-1883-script-detection" class="table-of-contents__link toc-highlight">Aggressive Scanning on Port 1883 Script Detection</a></li><li><a href="#mosquitto-and-mosquitto-clients-installation" class="table-of-contents__link toc-highlight">Mosquitto and Mosquitto Clients Installation</a></li><li><a href="#output-with-mqtt-subscribe-script" class="table-of-contents__link toc-highlight">Output with mqtt-subscribe Script</a><ul><li><a href="#purpose-2" class="table-of-contents__link toc-highlight">Purpose:</a></li><li><a href="#key-details-from-the-output-2" class="table-of-contents__link toc-highlight">Key Details from the Output:</a></li><li><a href="#wireshark-network-capture" class="table-of-contents__link toc-highlight">Wireshark Network Capture:</a></li><li><a href="#information-from-the-captured-packets" class="table-of-contents__link toc-highlight">Information from the Captured Packets:</a></li></ul></li><li><a href="#subscribing-to-all-topics-listening-port" class="table-of-contents__link toc-highlight">Subscribing to all topics Listening port</a></li><li><a href="#publishing-non-persistent-messages-in-mqtt" class="table-of-contents__link toc-highlight">Publishing Non-Persistent Messages in MQTT</a><ul><li><a href="#wireshark-network-capture-1" class="table-of-contents__link toc-highlight">Wireshark Network Capture:</a></li></ul></li><li><a href="#real-time-message-transmission-in-mqtt-with-retention" class="table-of-contents__link toc-highlight">Real-Time Message Transmission in MQTT with Retention</a><ul><li><a href="#wireshark-network-capture-2" class="table-of-contents__link toc-highlight">Wireshark Network Capture:</a></li><li><a href="#key-points" class="table-of-contents__link toc-highlight">Key Points:</a></li></ul></li><li><a href="#findings" class="table-of-contents__link toc-highlight">Findings:</a></li><li><a href="#suggestions" class="table-of-contents__link toc-highlight">Suggestions:</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion:</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Info</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/redback-documentation/docs/category/onboarding">Docs</a></li><li class="footer__item"><a href="https://github.com/Redback-Operations" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Redback Operations</div></div></div></footer></div>
</body>
</html>